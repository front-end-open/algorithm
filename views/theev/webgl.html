<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"><title>数据结构与算法</title><meta name="description" content="Vue 驱动的静态网站生成器">
    <link rel="modulepreload" href="/algorithm/assets/app.3aa91c68.js"><link rel="modulepreload" href="/algorithm/assets/webgl.html.6b0c2f6b.js"><link rel="modulepreload" href="/algorithm/assets/webgl.html.5e2ff444.js"><link rel="modulepreload" href="/algorithm/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/algorithm/assets/style.136af33d.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/algorithm/" class=""><img class="logo" src="https://avatars.githubusercontent.com/u/43908467?v=4" alt="数据结构与算法"><span class="site-name can-hide">数据结构与算法</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/algorithm/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/algorithm/views/guide/" class="" aria-label="文档"><!--[--><!--]--> 文档 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="leetcode"><span class="title">leetcode</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="leetcode"><span class="title">leetcode</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/leecode/" class="" aria-label="初级"><!--[--><!--]--> 初级 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/leecode/intermediate/" class="" aria-label="中级"><!--[--><!--]--> 中级 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="threeJs"><span class="title">threeJs</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="threeJs"><span class="title">threeJs</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/base.md" class="" aria-label="基本"><!--[--><!--]--> 基本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/practice.md" class="" aria-label="实践"><!--[--><!--]--> 实践 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/webgl.md" class="" aria-label="webgl"><!--[--><!--]--> webgl <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="css"><span class="title">css</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="css"><span class="title">css</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/css/index.md" class="" aria-label="概念"><!--[--><!--]--> 概念 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/css/practice.md" class="" aria-label="效果"><!--[--><!--]--> 效果 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Javascript"><span class="title">Javascript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Javascript"><span class="title">Javascript</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/js/index.md" class="" aria-label="语法"><!--[--><!--]--> 语法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/js/tips.md" class="" aria-label="技巧"><!--[--><!--]--> 技巧 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/algorithm/views/program/" class="" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/algorithm/views/english" class="" aria-label="词汇"><!--[--><!--]--> 词汇 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/front-end-open/algorithm" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/algorithm/views/theev/webgl.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/zh/" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/algorithm/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/algorithm/views/guide/" class="" aria-label="文档"><!--[--><!--]--> 文档 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="leetcode"><span class="title">leetcode</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="leetcode"><span class="title">leetcode</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/leecode/" class="" aria-label="初级"><!--[--><!--]--> 初级 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/leecode/intermediate/" class="" aria-label="中级"><!--[--><!--]--> 中级 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="threeJs"><span class="title">threeJs</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="threeJs"><span class="title">threeJs</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/base.md" class="" aria-label="基本"><!--[--><!--]--> 基本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/practice.md" class="" aria-label="实践"><!--[--><!--]--> 实践 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/webgl.md" class="" aria-label="webgl"><!--[--><!--]--> webgl <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="css"><span class="title">css</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="css"><span class="title">css</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/css/index.md" class="" aria-label="概念"><!--[--><!--]--> 概念 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/css/practice.md" class="" aria-label="效果"><!--[--><!--]--> 效果 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Javascript"><span class="title">Javascript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Javascript"><span class="title">Javascript</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/js/index.md" class="" aria-label="语法"><!--[--><!--]--> 语法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/js/tips.md" class="" aria-label="技巧"><!--[--><!--]--> 技巧 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/algorithm/views/program/" class="" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/algorithm/views/english" class="" aria-label="词汇"><!--[--><!--]--> 词汇 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/front-end-open/algorithm" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/algorithm/views/theev/webgl.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/zh/" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading"> <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#基本" class="router-link-active router-link-exact-active sidebar-item" aria-label="基本"><!--[--><!--]--> 基本 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#基本版本" class="router-link-active router-link-exact-active sidebar-item" aria-label="基本版本"><!--[--><!--]--> 基本版本 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#兼容性" class="router-link-active router-link-exact-active sidebar-item" aria-label="兼容性"><!--[--><!--]--> 兼容性 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#开始" class="router-link-active router-link-exact-active sidebar-item" aria-label="开始"><!--[--><!--]--> 开始 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#着色器基本" class="router-link-active router-link-exact-active sidebar-item" aria-label="着色器基本"><!--[--><!--]--> 着色器基本 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#顶点着色器-vertex-shader" class="router-link-active router-link-exact-active sidebar-item" aria-label="顶点着色器(Vertex shader)"><!--[--><!--]--> 顶点着色器(Vertex shader) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#片元着色器-fragment-shader" class="router-link-active router-link-exact-active sidebar-item" aria-label="片元着色器(Fragment shader)"><!--[--><!--]--> 片元着色器(Fragment shader) <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#着色器运行过程" class="router-link-active router-link-exact-active sidebar-item" aria-label="着色器运行过程"><!--[--><!--]--> 着色器运行过程 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#顶点着色器" class="router-link-active router-link-exact-active sidebar-item" aria-label="顶点着色器"><!--[--><!--]--> 顶点着色器 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#glsl-es-简单语法示列" class="router-link-active router-link-exact-active sidebar-item" aria-label="GLSL ES 简单语法示列"><!--[--><!--]--> GLSL ES 简单语法示列 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#片元着色器" class="router-link-active router-link-exact-active sidebar-item" aria-label="片元着色器"><!--[--><!--]--> 片元着色器 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#绘制操作" class="router-link-active router-link-exact-active sidebar-item" aria-label="绘制操作"><!--[--><!--]--> 绘制操作 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#webgl坐标系统" class="router-link-active router-link-exact-active sidebar-item" aria-label="WebGL坐标系统"><!--[--><!--]--> WebGL坐标系统 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#webgl坐标和canvas二维坐标映射" class="router-link-active router-link-exact-active sidebar-item" aria-label="webgl坐标和canvas二维坐标映射"><!--[--><!--]--> webgl坐标和canvas二维坐标映射 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#js程序与着色器数据传输" class="router-link-active router-link-exact-active sidebar-item" aria-label="js程序与着色器数据传输"><!--[--><!--]--> js程序与着色器数据传输 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#实践demo" class="router-link-active router-link-exact-active sidebar-item" aria-label="实践demo"><!--[--><!--]--> 实践demo <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#通过鼠标绘制" class="router-link-active router-link-exact-active sidebar-item" aria-label="通过鼠标绘制"><!--[--><!--]--> 通过鼠标绘制 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#坐标转换" class="router-link-active router-link-exact-active sidebar-item" aria-label="坐标转换"><!--[--><!--]--> 坐标转换 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#绘制原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="绘制原理"><!--[--><!--]--> 绘制原理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#动态绘制点的颜色" class="router-link-active router-link-exact-active sidebar-item" aria-label="动态绘制点的颜色"><!--[--><!--]--> 动态绘制点的颜色 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#uniform变量" class="router-link-active router-link-exact-active sidebar-item" aria-label="uniform变量"><!--[--><!--]--> uniform变量 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#赋值uniform" class="router-link-active router-link-exact-active sidebar-item" aria-label="赋值uniform"><!--[--><!--]--> 赋值uniform <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/webgl.html#总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="总结："><!--[--><!--]--> 总结： <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h2 id="基本" tabindex="-1"><a class="header-anchor" href="#基本" aria-hidden="true">#</a> 基本</h2><h3 id="基本版本" tabindex="-1"><a class="header-anchor" href="#基本版本" aria-hidden="true">#</a> 基本版本</h3><blockquote><p>webGL2.0现在版本基于OPENGL ES 2.0 迭代而来。</p></blockquote><h3 id="兼容性" tabindex="-1"><a class="header-anchor" href="#兼容性" aria-hidden="true">#</a> 兼容性</h3><blockquote><p>webGL 2的浏览器兼容性: Firefox 4+, Google Chrome 9+, Opera 12+, Safari 5.1+, Internet Explorer 11+和Microsoft Edge build 10240+；然而, WebGL一些特性也需要用户的硬件设备支持。</p></blockquote><h2 id="开始" tabindex="-1"><a class="header-anchor" href="#开始" aria-hidden="true">#</a> 开始</h2><blockquote><p>从一些基本例子开始.</p></blockquote><ul><li>初次使用着色器绘制一个矩形点。</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>      <span class="token comment">// 核心代码</span>
      <span class="token comment">// 着色器使用流程</span>
      <span class="token comment">// 1.编译 2.链接 3.使用 4.绘图</span>
      <span class="token comment">// 顶点着色器</span>
      <span class="token keyword">let</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
        <span class="token string">&quot;void main() {\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 设置坐标</span>
        <span class="token string">&quot;gl_PointSize = 10.0;\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 设置尺寸</span>
        <span class="token string">&quot;}\n&quot;</span><span class="token punctuation">;</span>

      <span class="token comment">// 片元着色器, 为顶点着色器设置颜色</span>
      <span class="token keyword">let</span> <span class="token constant">FSHADER_SOURCE</span> <span class="token operator">=</span>
        <span class="token string">&quot;void main() {\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 设置颜色</span>
        <span class="token string">&quot;}\n&quot;</span><span class="token punctuation">;</span>

      <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;glwebgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> gl <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;webgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;浏览器不支持webgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 编译</span>
        <span class="token keyword">let</span> vShader <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createShader</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">VERTEX_SHADER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">shaderSource</span><span class="token punctuation">(</span>vShader<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>vShader<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">.</span><span class="token function">getShaderParameter</span><span class="token punctuation">(</span>vShader<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">COMPILE_STATUS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
            <span class="token string">&quot;-----&gt;&gt;&gt;vShader 编译错误:&quot;</span><span class="token punctuation">,</span>
            gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>vShader<span class="token punctuation">)</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//片元着色器</span>
        <span class="token keyword">let</span> fShader <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createShader</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">FRAGMENT_SHADER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">shaderSource</span><span class="token punctuation">(</span>fShader<span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>fShader<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">.</span><span class="token function">getShaderParameter</span><span class="token punctuation">(</span>fShader<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">COMPILE_STATUS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
            <span class="token string">&quot;-----&gt;&gt;&gt;fShader 编译错误:&quot;</span><span class="token punctuation">,</span>
            gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>fShader<span class="token punctuation">)</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 连接</span>
        <span class="token comment">// 每一个shader必须和webgl的program连接。</span>
        <span class="token keyword">const</span> shaderProgram <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 添加预先存在的着色器</span>
        gl<span class="token punctuation">.</span><span class="token function">attachShader</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> vShader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">attachShader</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> fShader<span class="token punctuation">)</span><span class="token punctuation">;</span>

        gl<span class="token punctuation">.</span><span class="token function">linkProgram</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">.</span><span class="token function">getProgramParameter</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">LINK_STATUS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
            <span class="token string">&quot;------&gt;&gt;&gt;着色器链接失败: &quot;</span> <span class="token operator">+</span> gl<span class="token punctuation">.</span><span class="token function">getProgramInfoLog</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">)</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 使用</span>
        gl<span class="token punctuation">.</span><span class="token function">useProgram</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 绘图</span>
        gl<span class="token punctuation">.</span><span class="token function">drawElements</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">UNSIGNED_SHORT</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">POINTS</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>和canvas的2d画布不同，webgl中绘制矩形，需要使用着色器，来进行绘制。着色器本身提供了灵活且强大的二维和三维图形绘制功能。</p></div><div class="custom-container warning"><p class="custom-container-title">提示</p><p>WebGLProgram 是 WebGL API 的一部分，它由两个WebGLShaders （webgl 着色器）组成，分别为顶点着色器和片元着色器（两种着色器都是采用 GLSL 语言编写的）。创建一个 WebGLProgram 需要调用 GL 上下文的createProgram() 方法，然后调用attachShader()方法附加上着色器，之后你才能将它们连接到一个可用的程序。</p></div><div class="custom-container tip"><p class="custom-container-title">注意</p><p>要使用webgl绘图需要使用着色器</p></div><h3 id="着色器基本" tabindex="-1"><a class="header-anchor" href="#着色器基本" aria-hidden="true">#</a> 着色器基本</h3><blockquote><p>要使用webgl绘图依赖着色器. webgl着色器分类: 顶点着色器和片元着色器.</p></blockquote><h4 id="顶点着色器-vertex-shader" tabindex="-1"><a class="header-anchor" href="#顶点着色器-vertex-shader" aria-hidden="true">#</a> 顶点着色器(Vertex shader)</h4><blockquote><p>顶点着色器用来描述顶点特性（如位置和颜色等)的程序。顶点是指二维和三维空间中的一个点，比如二维和三维图形的端点和交点。</p></blockquote><h4 id="片元着色器-fragment-shader" tabindex="-1"><a class="header-anchor" href="#片元着色器-fragment-shader" aria-hidden="true">#</a> 片元着色器(Fragment shader)</h4><blockquote><p>进行逐片元处理过程如光照的程序。片元是一个webGL术语，可以理解为像素（也是可以理解为图像的像素单元）</p></blockquote><div class="custom-container tip"><p class="custom-container-title">提示</p><p>着色器能够处理三维场景中的图形绘制和颜色处理。同时也能够处理光照变化对应的图形透过视角的颜色状态，以及观察者视野变化时的视角变化。</p></div><p><strong>webgl中图形绘制流程</strong><img src="http://assets.processon.com/chart_image/621905b85653bb07564f66d1.png">`</p><div class="custom-container tip"><p class="custom-container-title">提示</p><p>着色器使用类似于c语言的OpenGL ES 着色器语言</p></div><p><strong>WebGL程序流程</strong></p><img src="http://assets.processon.com/chart_image/5e9b1cf01e085369d0d11fc0.png"><h3 id="着色器运行过程" tabindex="-1"><a class="header-anchor" href="#着色器运行过程" aria-hidden="true">#</a> 着色器运行过程</h3><blockquote><p>着色器语言使用GLEL ES 语言编写。在js语言中使用字符串形式声明。此时的着色器语言只是字符串。需要通过webgl系统进行编译才能用于三维场景的绘图。</p></blockquote><p>流程:</p><ol><li>着色器声明</li><li>编译</li><li>链接</li><li>使用</li></ol><blockquote><p>上面的示列中，着色器在被初始化之前都是空白的，需要将字符串形式的着色器代码从js传给Webgl系统，并建立着色器。 两个着色器在通过webgl处理时，首先是将顶点着色器的位置和size传入到片元着色器，然后再是执行片元着色器。片元着色器接收到的是经过光栅化处理后的片元值。</p></blockquote><div class="custom-container warning"><p class="custom-container-title">注意</p><p>着色器运行在webgl系统中，而不是在js程序中。</p></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>webgl程序包括运行在浏览器中的js和运行在webgl系统中的着色器两部分</p></div><h4 id="顶点着色器" tabindex="-1"><a class="header-anchor" href="#顶点着色器" aria-hidden="true">#</a> 顶点着色器</h4><blockquote><p>顶点着色器控制点的大小和位置,片元控制器控制点的颜色。</p></blockquote><h5 id="glsl-es-简单语法示列" tabindex="-1"><a class="header-anchor" href="#glsl-es-简单语法示列" aria-hidden="true">#</a> GLSL ES 简单语法示列</h5><div class="language-GLSLES ext-GLSLES line-numbers-mode"><pre class="language-GLSLES"><code>void main() {
    gl_Position = vec4(0.0, 0.0, 0.0, 1.0) 
    gl_PointSize = 10.0;
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>分析:</strong></p><ol><li><p>这里的位置变量存储了点的位置三维坐标，是一个三维矢量。在GLSLES中，该变量的类型是vec4类型（其实是有三个基本的浮点型量组合而成的), vec4是着色器提供的内置函数，用来创建齐次坐标。上面的坐标变量中，第四个分量<em>1.0</em>的加入，就创建了齐次坐标。</p></li><li><p>如果vec4的第四个分量传入1那么这个齐次坐标是等价于三维坐标的</p></li></ol><blockquote><p>齐次坐标(x, y, z, w)等价于(x/w, y/w, z/w)</p></blockquote><ol start="3"><li><p>注意第四个分量不能等于零。可以是趋近于零的数，这时齐次坐标就有了无穷量的概念。</p></li><li><p>齐次坐标想表示三维坐标点，可以将vec4第四个分量的值改为1.0即可。</p></li></ol><p><strong>齐次坐标的应用</strong></p><blockquote><p>齐次坐标的存在，使得用矩阵乘法来描述顶点变成可能，三维图形系统在计算过程中，通常使用齐次坐标来表示顶点的三维坐标。</p></blockquote><h4 id="片元着色器" tabindex="-1"><a class="header-anchor" href="#片元着色器" aria-hidden="true">#</a> 片元着色器</h4><blockquote><p>片元着色器设置点的颜色</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">FSHADER_SOURCE</span> <span class="token operator">=</span> 
<span class="token string">&#39;void main() {\n&#39;</span> <span class="token operator">+</span> 
<span class="token string">&#39; gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n&#39;</span> <span class="token operator">+</span> 
<span class="token string">&#39;}\n&#39;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>分析:</strong></p><blockquote><p>着色器程序代码如同顶点着色器一样，被分配到程序中。其中，gl_FragColor是webgl内置程序变量用来设置存储片元的颜色。</p></blockquote><p>gl_FragColor: 此变量和顶点着色器的位置变量是一样的，为Vec4类型。带有四个浮点类型分量.</p><table><thead><tr><th>类型</th><th>变量名</th><th>描述</th></tr></thead><tbody><tr><td>vec4</td><td>gl_FragColor</td><td>指定片元的颜色(RGBA格式)</td></tr></tbody></table><h3 id="绘制操作" tabindex="-1"><a class="header-anchor" href="#绘制操作" aria-hidden="true">#</a> 绘制操作</h3><blockquote><p>建立着色器过后，然后是进行绘制操作。在进行绘制之前，需要清空canvas.最后调用gl.drawArrays进行绘制。</p></blockquote><p><strong>gl.drawArrays介绍</strong></p><blockquote><p>gl.drawArrays(mode, first, count)，该函数用来绘制各种图形</p></blockquote><table><thead><tr><th>参数</th><th>说明</th><th>返回值</th><th>错误</th></tr></thead><tbody><tr><td>mode</td><td>指定绘制方式，可接收常量：gl.POINTS, gl.LINES, gl.LINES_STRIP, gl.LINE_LOOP,gl.TRIANGLES, gl.TRIANGLES_STRIP, gl.TRIANGLES_FAN</td><td></td><td></td></tr><tr><td>first</td><td>指定从哪一个顶点开始绘制,整形（int）</td><td></td><td></td></tr><tr><td>count</td><td>指定需要用到多少个顶点，整形（int）</td><td></td><td></td></tr><tr><td>--</td><td>--</td><td>无</td><td>参数first和count是负数</td></tr></tbody></table><h3 id="webgl坐标系统" tabindex="-1"><a class="header-anchor" href="#webgl坐标系统" aria-hidden="true">#</a> WebGL坐标系统</h3><blockquote><p>webgl处理的是三维图形，应用三维坐标系统（笛卡尔坐标系），具有x轴，y轴，z轴.坐标系各轴方向，以计算机屏幕正方向观察角度讲解，x轴的方向为正方向向右，y轴为正方向向下，z轴为正方向朝向屏幕外。关于此坐标系，也可以参考右手的拇指，食指，中指撑开表示，因此此坐标系也称之为webgl的右手坐标系。webgl默认使用右手坐标系（暂时这样认为，真是情况远比这复杂）。</p></blockquote><h4 id="webgl坐标和canvas二维坐标映射" tabindex="-1"><a class="header-anchor" href="#webgl坐标和canvas二维坐标映射" aria-hidden="true">#</a> webgl坐标和canvas二维坐标映射</h4><blockquote><p>两者坐标系，前者建立在三维空间，后者建立在二维平面。需要将前者转换为后者。</p></blockquote><p>默认情况，两者坐标系对应关系</p><ol><li>canvas中心点:(0.0, 0.0, 0.0)</li><li>canvas的上边缘和下边缘: (-1.0, 0.0, 0.0)和(1.0, 0.0, 0.0)</li><li>canvas的左边缘和右边缘: (0.0, -1.0, 0.0)和(0.0, 1.0, 0.0)</li></ol><div class="custom-container tip"><p class="custom-container-title">提示</p><p>OpenGL 需要交换颜色缓冲区，而在webgl系统中不需要交换颜色缓冲区.</p></div><h3 id="js程序与着色器数据传输" tabindex="-1"><a class="header-anchor" href="#js程序与着色器数据传输" aria-hidden="true">#</a> js程序与着色器数据传输</h3><blockquote><p>本节仍然是通过示列1的列子来进行演示。示列1绘制一个点，然而顶点着色器部分是通过硬编码的方式声明在js中的，包括顶点坐标数据等，都是字符串硬编码方式，使得如果想通过外部传入顶点数据到着色器变得困难，或者说根本无法实现。导致程序可扩展变得困难。现在使用attribute关键字来实现，外部程序向着色器传输数据。</p></blockquote><p><strong>使用attribute</strong></p><blockquote><p>目标: 传输位置信息到顶点着色器，两种实现方式。分别是：attribute和uniform变量。选择的那种方式取决于需要传递的数据本身。</p></blockquote><ul><li>attribute变量用来传输与顶点相关的数据</li><li>uniform用来传输与顶点无关的数据（或者对于所有顶点数据相同的数据）。此列使用attribute变量，取决于不同的顶点具有不同的坐标。</li></ul><p><strong>向顶点着色器传输数据的两种方式</strong></p><img src="http://assets.processon.com/chart_image/5e9b1cf01e085369d0d11fc0.png"><div class="custom-container tip"><p class="custom-container-title">提示</p><p>attribute 是一种GLSL ES变量，被用来从外部向顶点着色器内部传输数据，只有顶点着色器能够使用。</p></div><p><strong>声明attribute变量</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
    <span class="token string">&quot;attribute vec4 a_Position;\n&quot;</span> <span class="token operator">+</span>
    <span class="token string">&quot;void main() {\n&quot;</span> <span class="token operator">+</span>
    <span class="token string">&quot;gl_Position = a_Position;\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 复制attribute变量给gl_Position</span>
    <span class="token string">&quot;gl_PointSize = 10.0;\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 设置尺寸</span>
    <span class="token string">&quot;}\n&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>分析:</strong></p><p><code>js attribute vec4 a_Position</code></p><p>1.关键字attribute称之为存储限定符，表示接下来的一个变量是一个attribute变量,且attribute变量需要声明成全局变量。 数据从着色器外部传给该变量</p><ol start="2"><li>attribute声明格式: attribute [类型] variable_name</li></ol><p>此时，就可以从外部向着色器传输变量</p><p><strong>获取attribute变量的存储位置</strong></p><blockquote><p>要获取声明在webgl程序内部着色器内部的变量，需要调用getAttribLocation函数。</p></blockquote><p><strong>gl.getAttribLocation分析</strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>program</td><td>指定包括顶点和片元着色器的程序对象(program object)</td></tr><tr><td>name</td><td>需要获取的attribute变量的名字</td></tr><tr><td>返回值</td><td>大于等于零，是attributet变量的内存地址;-1, 表示该变量不存在，或者是变量标识符有gl_或webgl_前缀</td></tr><tr><td>错误</td><td>INVALID_OPERATION, 程序对象未能成功连接; INVALID_VALUE,name长度大于attribute变量名的最大长度限制（默认256字节）</td></tr></tbody></table><p><strong>向attribute变量赋值</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>gl<span class="token punctuation">.</span><span class="token function">vertexAttrib3f</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><strong>gl.vertexAttrib3f规范</strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>location</td><td>attribute变量存储位置</td></tr><tr><td>v0</td><td>需要修改的attribute变量的第一个分量值</td></tr><tr><td>v1</td><td></td></tr><tr><td>v2</td><td>需要修改的attribute变量的第三个分量值</td></tr><tr><td>返回值</td><td>无</td></tr><tr><td>错误</td><td>INVALID_OPERATION: 没有当前program对象;INVALID_VALUE: location大于等于attribute变量的最大数目</td></tr></tbody></table><div class="custom-container tip"><p class="custom-container-title">提示</p><p>由于attribute变量和gl_Position变量的类型都是vec4，而使用外部位置数据传入到着色器时，只有三个分量数据。少了一个齐次坐标补齐的数据。这种情况下，vertexAttrib3f函数默认会将第四个分量w设置为1.0. 而齐次坐标中w等于1.0的话，是等价于三维坐标的，因此这是一个安全的第四分量。</p></div><p><strong>getAttribute3f同族函数</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>gl.vertexAttrib1f(location, v0)
gl.vertexAttrib2f(location, v0, v1)
gl.vertexAttrib3f(location, v0, v1, v2)
gl.vertexAttrib4f(location, v0, v1, v2, v3);
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>说明：这些函数都是给location参数指定的attribute变量传输数据。gl.vertexAttrib1f仅传输一个值，这个值将被填充到attribute变量的第一个分量中，第2，3个分量将被设置为0.0，第四个分量将被设置为1.0. 其他同族函数，以此类推。</p><div class="custom-container tip"><p class="custom-container-title">提示</p><p>vertexAttrib[n]fv传入分量参数时，也可以使用矢量。他们以vector结尾。并接受类型数组作为参数。函数名字中数字表示这些分量元素个数。vertexAttrib4f,表示分量有四个元素</p></div><h3 id="实践demo" tabindex="-1"><a class="header-anchor" href="#实践demo" aria-hidden="true">#</a> 实践demo</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;IE=edge&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>webgl<span class="token operator">-</span>修改点的尺寸<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>body onload<span class="token operator">=</span><span class="token string">&quot;main()&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>canvas id<span class="token operator">=</span><span class="token string">&quot;glwebgl&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;400&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;400&quot;</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">/</span>canvas<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;../../js//helper/helper.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
      <span class="token comment">// 着色器使用流程</span>
      <span class="token comment">// 1.编译 2.链接 3.使用 4.绘图</span>
      <span class="token comment">// 顶点着色器</span>
      <span class="token comment">// 添加 attribute- a_PointSize</span>
      <span class="token doc-comment comment">/**
       *  1. 顶点着色器中，声明attribute变量;
       *  2. 将attribute变量复制给gl_PointSize变量
       *  3. 向attribute变量传输数据
       */</span>
      <span class="token keyword">let</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
        <span class="token string">&quot;attribute vec4 a_Position;\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;attribute float a_PointSize;\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;void main() {\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;gl_Position = a_Position;\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 赋值attribute变量给gl_Position</span>
        <span class="token string">&quot;gl_PointSize = a_PointSize;\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 赋值attribute变量到gl_PointSize</span>
        <span class="token string">&quot;}\n&quot;</span><span class="token punctuation">;</span>

      <span class="token comment">// 片元着色器, 为顶点着色器设置颜色</span>
      <span class="token keyword">let</span> <span class="token constant">FSHADER_SOURCE</span> <span class="token operator">=</span>
        <span class="token string">&quot;void main() {\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;gl_FragColor = vec4(0.0, 1.0, 0.0, 0.5);\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 设置颜色</span>
        <span class="token string">&quot;}\n&quot;</span><span class="token punctuation">;</span>

      <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;glwebgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> gl <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;webgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;浏览器不支持webgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 初始化着色器</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">initShader</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">erro</span><span class="token punctuation">(</span><span class="token string">&quot;着色器初始化失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 获取attribute-a_Position</span>
        <span class="token keyword">let</span> a_Position <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">&quot;a_Position&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>a_Position <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;获取本地attribute变量-a_Position失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 获取attribute-a_PointSize</span>
        <span class="token keyword">let</span> a_PointSize <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">&quot;a_PointSize&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a_PointSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>a_PointSize <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;获取本地attribute变量-a_PointSize失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 传输顶点数据到attribute-a_Position</span>
        <span class="token comment">// 修改vertexAttrib3f，测试同族函数vertexAttrib[1234]f</span>
        gl<span class="token punctuation">.</span><span class="token function">vertexAttrib3f</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 修改顶点y轴坐标到0.5</span>
        gl<span class="token punctuation">.</span><span class="token function">vertexAttrib1f</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 绘制在中心（0.0， 0.0， 0.0）</span>
        gl<span class="token punctuation">.</span><span class="token function">vertexAttrib2f</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 绘制在(0.0, 0.5, 0.0)</span>
        gl<span class="token punctuation">.</span><span class="token function">vertexAttrib4f</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (0.0, 1.0, 0.0, 1.0)</span>

        <span class="token comment">// 使用矢量</span>
        <span class="token keyword">let</span> position <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [0.0, 0.0, 0.0, 1.0]</span>
        gl<span class="token punctuation">.</span><span class="token function">vertexAttrib1fv</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> position<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> positionv1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [0.0, 0.5, 0.0, 1.0]</span>
        gl<span class="token punctuation">.</span><span class="token function">vertexAttrib2fv</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> positionv1<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> positionv2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [0.0, 0.5, 0.5, 1.0]</span>
        gl<span class="token punctuation">.</span><span class="token function">vertexAttrib3fv</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> positionv2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> positionv3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [0.0, 0.0, 0.0, 1.0]</span>
        gl<span class="token punctuation">.</span><span class="token function">vertexAttrib4fv</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> positionv3<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 传输顶点尺寸数据到attribute-a_PointSize</span>
        <span class="token keyword">let</span> size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">vertexAttrib1fv</span><span class="token punctuation">(</span>a_PointSize<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>

        gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 4. 绘图</span>
        gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">POINTS</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br></div></div><h3 id="通过鼠标绘制" tabindex="-1"><a class="header-anchor" href="#通过鼠标绘制" aria-hidden="true">#</a> 通过鼠标绘制</h3><blockquote><p>前面的两个例子中，顶点着色器的位置数据都是硬编码在js中和着色器中的。现在通过鼠标点击事件的方式动态创建点。</p></blockquote><p>示列代码</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 核心业务代码</span>
canvas<span class="token punctuation">.</span><span class="token function-variable function">onmousedown</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 获取鼠标点击位置</span>
          <span class="token keyword">let</span> x <span class="token operator">=</span> ev<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
            y <span class="token operator">=</span> ev<span class="token punctuation">.</span>clientY<span class="token punctuation">;</span>

          <span class="token keyword">let</span> rect <span class="token operator">=</span> ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取canvas尺寸和相对viewport位置</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment">// 核心</span>
          x <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> rect<span class="token punctuation">.</span>left <span class="token operator">-</span> canvas<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          y <span class="token operator">=</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> rect<span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment">// 存储坐标到g_points中</span>
          g_points<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
          g_points<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

          gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">let</span> len <span class="token operator">=</span> g_points<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            gl<span class="token punctuation">.</span><span class="token function">vertexAttrib3f</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> g_points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> g_points<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">POINTS</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h4 id="坐标转换" tabindex="-1"><a class="header-anchor" href="#坐标转换" aria-hidden="true">#</a> 坐标转换</h4><blockquote><p>通过点击事件<code>mousedown</code>来获取鼠标坐标，此后根据此坐标来动态创建点。因为某些原因不能直接使用此坐标.</p></blockquote><p>不能直接使用鼠标坐标的理由:</p><ul><li>鼠标位置坐标是鼠标在浏览器客户区的坐标，而不是在canvas中的坐标</li><li>canvas的坐标系统与webgl的坐标系统，其原点位置和y轴的正方向都不一样.</li></ul><p><em>为了能够使用鼠标坐标,需要将鼠标位置从，浏览器客户端坐标转换为canvas下的坐标，然后再转webgl坐标。</em></p><p><strong>转换原理</strong></p><blockquote><p>以代码分析</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">-</span> rect<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">-</span> canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> rect<span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>height<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>说明：</p><ol><li><p>首先是客户端坐标转canvas坐标，由于客户端坐标和canvas坐标轴的方向是一致的，只是两者的原点坐标不一致，代码中<code>x - rect.left, y - rect.top</code>.完成了浏览器客户端到canvas坐标转换</p></li><li><p>紧接着是canvas坐标到webgl坐标的转换. 由于canvas坐标系统的y轴正方向以及坐标原点和webgl坐标系不是一致的。首先需要改变y轴正方向，即y坐标的转换时，用负号表示即可。然后，平移坐标原点，平移的原理是，利用canvas坐标的各分量减去canvas宽高的二分之一即可，这样做的目的是，webgl坐标系的原点是在画布中心。（0.0， 0.0， 0.0）处, 且webgl坐标系的各分量区间是(-1.0, 1.0)</p></li></ol><h4 id="绘制原理" tabindex="-1"><a class="header-anchor" href="#绘制原理" aria-hidden="true">#</a> 绘制原理</h4><blockquote><p>在确定好webgl坐标系后，然后需要存储鼠标点击的每次坐标值。</p></blockquote><div class="custom-container tip"><p class="custom-container-title">提示</p><p>通过鼠标点击绘制过程中，需要缓存每次鼠标点击的位置目的在于，webgl使用的是颜色缓冲区绘图的，绘制结束后然后将颜色缓冲区呈现到屏幕上，最后会重置颜色缓冲区，之前的绘制内容也会丢失。为了能够显示每次鼠标点击的绘制点，需要缓存每次鼠标点击的位置。</p></div><h4 id="动态绘制点的颜色" tabindex="-1"><a class="header-anchor" href="#动态绘制点的颜色" aria-hidden="true">#</a> 动态绘制点的颜色</h4><blockquote><p>在上面的示列，改进绘制点的颜色。前面的例子片元颜色是硬编码写死在着色器中的，现在改进颜色写入方法。通过外部传入到着色器中。这里使用uniform变量。在js中传入数据到着色器</p></blockquote><p>代码实现:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;IE=edge&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>改变绘制点的颜色<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>body onload<span class="token operator">=</span><span class="token string">&quot;main()&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>canvas id<span class="token operator">=</span><span class="token string">&quot;glwebgl&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;1000&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;1000&quot;</span><span class="token operator">&gt;</span>浏览器不支持canvas<span class="token operator">&lt;</span><span class="token operator">/</span>canvas<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;../../js/helper/helper.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
      <span class="token keyword">let</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span>
        <span class="token string">&quot;attribute vec4 a_Position;\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;void main() {\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;gl_Position = a_Position;\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 复制attribute变量给gl_Position</span>
        <span class="token string">&quot;gl_PointSize = 10.0;\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 设置尺寸</span>
        <span class="token string">&quot;}\n&quot;</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> <span class="token constant">FSHADER_SOURCE</span> <span class="token operator">=</span>
        <span class="token string">&quot;precision mediump float;\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;uniform vec4 u_FragColor;\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 赋值uniform变脸到gl_FragColor</span>
        <span class="token string">&quot;void main() {\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;gl_FragColor = u_FragColor;\n&quot;</span> <span class="token operator">+</span> <span class="token comment">// 设置颜色</span>
        <span class="token string">&quot;}\n&quot;</span><span class="token punctuation">;</span>

      <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;glwebgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> gl <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;webgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;浏览器不支持webgl绘图&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">initShader</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;着色器初始化失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 获取点的本地坐标变量</span>
        <span class="token keyword">let</span> a_Position <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">&quot;a_Position&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a_Position <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;获取a_Position本地变量失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 获取点片元变量</span>
        <span class="token keyword">let</span> u_FragColor <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span>program<span class="token punctuation">,</span> <span class="token string">&quot;u_FragColor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>u_FragColor<span class="token punctuation">)</span><span class="token punctuation">;</span>

        gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 注册鼠标按下事件</span>
        <span class="token keyword">let</span> g_points <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 鼠标点击位置数组</span>
        <span class="token keyword">let</span> g_colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 存储点颜色数组</span>
        canvas<span class="token punctuation">.</span><span class="token function-variable function">onmousedown</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 获取鼠标点击位置</span>
          <span class="token keyword">let</span> x <span class="token operator">=</span> ev<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
            y <span class="token operator">=</span> ev<span class="token punctuation">.</span>clientY<span class="token punctuation">;</span>

          <span class="token keyword">let</span> rect <span class="token operator">=</span> ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取canvas尺寸和相对viewport位置</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment">// 核心</span>
          x <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> rect<span class="token punctuation">.</span>left <span class="token operator">-</span> canvas<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          y <span class="token operator">=</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> rect<span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment">// 存储坐标到g_points中</span>
          g_points<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment">// 存储点颜色到数组</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;=</span> <span class="token number">0.0</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">&gt;=</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 第一象限</span>
            g_colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 红色</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0.0</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">&lt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 第三象限</span>
            g_colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 绿色</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 其他</span>
            g_colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 白色</span>
          <span class="token punctuation">}</span>

          gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从新清空canvas背景在于，每次绘制结束后，webgl会重置颜色缓冲区默认背景(0.0, 0.0, 0.0, 0.0), 黑色纯透明。看到的结果就是白色。</span>

          <span class="token keyword">let</span> len <span class="token operator">=</span> g_points<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> xy <span class="token operator">=</span> g_points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
              rgba <span class="token operator">=</span> g_colors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

            gl<span class="token punctuation">.</span><span class="token function">vertexAttrib3f</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> xy<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> xy<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            gl<span class="token punctuation">.</span><span class="token function">uniform4f</span><span class="token punctuation">(</span>u_FragColor<span class="token punctuation">,</span> rgba<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rgba<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rgba<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rgba<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">POINTS</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br></div></div><p>分析: 这里动态绘制点的颜色方法，同动态传入顶点位置的方法一样。不同的是这里使用了uniform作为数据传入方法。</p><h5 id="uniform变量" tabindex="-1"><a class="header-anchor" href="#uniform变量" aria-hidden="true">#</a> uniform变量</h5><blockquote><p>uniform变量用来向顶点和片元着色器传输一致的不变的数据.</p></blockquote><p><strong>声明格式：存储限定符uniform 类型 变量名</strong></p><div class="custom-container tip"><p class="custom-container-title">提示</p><p>GLSL ES 中，只能为attribute变量指定float类型，但可以指定任意类型的uniform变量。</p></div><p><strong>uniform变量声明规则点</strong></p><ol><li>统一变量标识符的名称以<code>u_</code>作为变量前缀。</li><li>uniform变量需要统一为，需要被赋值gl_FragColor的类型</li></ol><p><strong>精度限定词:</strong></p><blockquote><p>下面代码段用来指定代码的范围（最大值和最小值）和精度，本例为中等精度。</p></blockquote><p><code>js predision mediump float</code></p><p><strong>uniform传递数据步骤</strong></p><ol><li><p>首先在webgl中获取uniform变量地址</p></li><li><p>向地址中传入数据.</p></li></ol><p><strong>获取uniform变量地址</strong></p><blockquote><p>gl.getUniformLocation 获取uniform变量地址</p></blockquote><p>方法说明:</p><table><thead><tr><th>参数</th><th>描述</th><th>返回值</th><th>错误</th></tr></thead><tbody><tr><td>program</td><td>指定程序对象</td><td>----</td><td>-----</td></tr><tr><td>name</td><td>指定uniform变量名字</td><td>----</td><td>----</td></tr><tr><td>----</td><td>----</td><td>no-null: uniform变量位置</td><td>-----</td></tr><tr><td>----</td><td>----</td><td>null: 指定uniform变量不存在，或者变量名具有gl_或webgl_前缀</td><td>-----</td></tr><tr><td>----</td><td>----</td><td>-----</td><td>INVALID_OPERATION:程序对象未连接</td></tr><tr><td>----</td><td>----</td><td>-----</td><td>INVALID_VALUE：name参数长度大于uniform变量名的最大长度（max:256字节)</td></tr></tbody></table><div class="custom-container tip"><p class="custom-container-title">提示</p><p>说明：获取uniform变量的函数和获取attribute变量的函数大致一样。不同的是，uniform参数的返回值，在变量不存在或命名使用保留字时，返回的是null; 而attribute在这种情况下返回的是-1.</p></div><h5 id="赋值uniform" tabindex="-1"><a class="header-anchor" href="#赋值uniform" aria-hidden="true">#</a> 赋值uniform</h5><blockquote><p>在通过getUniformLocation获取变量地址后，再使用gl.uniform4f向变量赋值.该方法与gl.getAttribute[1234]f很类似</p></blockquote><p><strong>gl.uniform4f</strong></p><table><thead><tr><th>参数</th><th>描述</th><th>返回值</th><th>错误</th></tr></thead><tbody><tr><td>location</td><td>指定要修改的uniform变量地址</td><td>----</td><td>----</td></tr><tr><td>v0</td><td>指定需要填充的第一分量</td><td>----</td><td>----</td></tr><tr><td>v1</td><td>指定需要填充的第二分量</td><td>----</td><td>----</td></tr><tr><td>v2</td><td>指定需要填充的第三分量</td><td>----</td><td>----</td></tr><tr><td>v3</td><td>指定需要填充的第四分量</td><td>----</td><td>----</td></tr><tr><td>----</td><td>----</td><td>无</td><td>----</td></tr><tr><td>-----</td><td>----</td><td>----</td><td>INVALID_OPERATION: 没有当前得program对象，或者location是非法的变量存储位置</td></tr></tbody></table><p><strong>gl.uniform4f同族函数</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>gl<span class="token punctuation">.</span><span class="token function">uniform1f</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> v0<span class="token punctuation">)</span>
gl<span class="token punctuation">.</span><span class="token function">uniform2f</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> v0<span class="token punctuation">,</span> v1<span class="token punctuation">)</span>
gl<span class="token punctuation">.</span><span class="token function">uniform3f</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> v0<span class="token punctuation">,</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span>
gl<span class="token punctuation">.</span><span class="token function">uniform4f</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> v0<span class="token punctuation">,</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">,</span> v3<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>说明: 函数上的数字代表传入分量的个数。</p><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结：</h3><p>顶点着色器进行的是逐顶点的操作，片元着色器进行的是逐片元的操作。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">最近更新于: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 22212@qq.com">wangshan</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/algorithm/assets/app.3aa91c68.js" defer></script>
  </body>
</html>
