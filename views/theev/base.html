<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"><title>数据结构与算法</title><meta name="description" content="Vue 驱动的静态网站生成器">
    <link rel="modulepreload" href="/algorithm/assets/app.3aa91c68.js"><link rel="modulepreload" href="/algorithm/assets/base.html.3ac3cde5.js"><link rel="modulepreload" href="/algorithm/assets/base.html.bc35909e.js"><link rel="modulepreload" href="/algorithm/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/algorithm/assets/style.136af33d.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/algorithm/" class=""><img class="logo" src="https://avatars.githubusercontent.com/u/43908467?v=4" alt="数据结构与算法"><span class="site-name can-hide">数据结构与算法</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/algorithm/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/algorithm/views/guide/" class="" aria-label="文档"><!--[--><!--]--> 文档 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="leetcode"><span class="title">leetcode</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="leetcode"><span class="title">leetcode</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/leecode/" class="" aria-label="初级"><!--[--><!--]--> 初级 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/leecode/intermediate/" class="" aria-label="中级"><!--[--><!--]--> 中级 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="threeJs"><span class="title">threeJs</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="threeJs"><span class="title">threeJs</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/base.md" class="" aria-label="基本"><!--[--><!--]--> 基本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/practice.md" class="" aria-label="实践"><!--[--><!--]--> 实践 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/webgl.md" class="" aria-label="webgl"><!--[--><!--]--> webgl <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="css"><span class="title">css</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="css"><span class="title">css</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/css/index.md" class="" aria-label="概念"><!--[--><!--]--> 概念 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/css/practice.md" class="" aria-label="效果"><!--[--><!--]--> 效果 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Javascript"><span class="title">Javascript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Javascript"><span class="title">Javascript</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/js/index.md" class="" aria-label="语法"><!--[--><!--]--> 语法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/js/tips.md" class="" aria-label="技巧"><!--[--><!--]--> 技巧 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/algorithm/views/program/" class="" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/algorithm/views/english" class="" aria-label="词汇"><!--[--><!--]--> 词汇 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/front-end-open/algorithm" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/algorithm/views/theev/base.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/zh/" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/algorithm/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/algorithm/views/guide/" class="" aria-label="文档"><!--[--><!--]--> 文档 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="leetcode"><span class="title">leetcode</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="leetcode"><span class="title">leetcode</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/leecode/" class="" aria-label="初级"><!--[--><!--]--> 初级 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/leecode/intermediate/" class="" aria-label="中级"><!--[--><!--]--> 中级 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="threeJs"><span class="title">threeJs</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="threeJs"><span class="title">threeJs</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/base.md" class="" aria-label="基本"><!--[--><!--]--> 基本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/practice.md" class="" aria-label="实践"><!--[--><!--]--> 实践 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/theev/webgl.md" class="" aria-label="webgl"><!--[--><!--]--> webgl <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="css"><span class="title">css</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="css"><span class="title">css</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/css/index.md" class="" aria-label="概念"><!--[--><!--]--> 概念 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/css/practice.md" class="" aria-label="效果"><!--[--><!--]--> 效果 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Javascript"><span class="title">Javascript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Javascript"><span class="title">Javascript</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/algorithm/views/js/index.md" class="" aria-label="语法"><!--[--><!--]--> 语法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/views/js/tips.md" class="" aria-label="技巧"><!--[--><!--]--> 技巧 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/algorithm/views/program/" class="" aria-label="编程"><!--[--><!--]--> 编程 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/algorithm/views/english" class="" aria-label="词汇"><!--[--><!--]--> 词汇 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/front-end-open/algorithm" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/algorithm/views/theev/base.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/algorithm/zh/" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading"> <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#base" class="router-link-active router-link-exact-active sidebar-item" aria-label="Base"><!--[--><!--]--> Base <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#顶点概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="顶点概念"><!--[--><!--]--> 顶点概念 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#类型数组" class="router-link-active router-link-exact-active sidebar-item" aria-label="类型数组"><!--[--><!--]--> 类型数组 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#几种不同数组创建方式对应的内存分配图" class="router-link-active router-link-exact-active sidebar-item" aria-label="几种不同数组创建方式对应的内存分配图"><!--[--><!--]--> 几种不同数组创建方式对应的内存分配图 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#类型数组构造函数表" class="router-link-active router-link-exact-active sidebar-item" aria-label="类型数组构造函数表"><!--[--><!--]--> 类型数组构造函数表 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#类型数组属性" class="router-link-active router-link-exact-active sidebar-item" aria-label="类型数组属性"><!--[--><!--]--> 类型数组属性 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#类型数组属性对照表" class="router-link-active router-link-exact-active sidebar-item" aria-label="类型数组属性对照表"><!--[--><!--]--> 类型数组属性对照表 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#类型数组方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="类型数组方法"><!--[--><!--]--> 类型数组方法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#类型数组视图内存分配对比" class="router-link-active router-link-exact-active sidebar-item" aria-label="类型数组视图内存分配对比"><!--[--><!--]--> 类型数组视图内存分配对比 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#顶点" class="router-link-active router-link-exact-active sidebar-item" aria-label="顶点"><!--[--><!--]--> 顶点 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#顶点法向量" class="router-link-active router-link-exact-active sidebar-item" aria-label="顶点法向量"><!--[--><!--]--> 顶点法向量 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#漫反射-镜面反射" class="router-link-active router-link-exact-active sidebar-item" aria-label="漫反射，镜面反射."><!--[--><!--]--> 漫反射，镜面反射. <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#顶点索引自定义实现立方体" class="router-link-active router-link-exact-active sidebar-item" aria-label="顶点索引自定义实现立方体"><!--[--><!--]--> 顶点索引自定义实现立方体 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#buffergemotry-总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="BufferGemotry 总结"><!--[--><!--]--> BufferGemotry 总结 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#几何体对象数据访问" class="router-link-active router-link-exact-active sidebar-item" aria-label="几何体对象数据访问"><!--[--><!--]--> 几何体对象数据访问 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#访问外部模型几何体顶点数据" class="router-link-active router-link-exact-active sidebar-item" aria-label="访问外部模型几何体顶点数据"><!--[--><!--]--> 访问外部模型几何体顶点数据 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#材质对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="材质对象"><!--[--><!--]--> 材质对象 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#材质对象和模型对象对应关系" class="router-link-active router-link-exact-active sidebar-item" aria-label="材质对象和模型对象对应关系"><!--[--><!--]--> 材质对象和模型对象对应关系 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#模型对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="模型对象"><!--[--><!--]--> 模型对象 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#点模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="点模型"><!--[--><!--]--> 点模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#线模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="线模型"><!--[--><!--]--> 线模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#网格模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="网格模型"><!--[--><!--]--> 网格模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#模型对象变换" class="router-link-active router-link-exact-active sidebar-item" aria-label="模型对象变换"><!--[--><!--]--> 模型对象变换 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#缩放变换-scale" class="router-link-active router-link-exact-active sidebar-item" aria-label="缩放变换- scale"><!--[--><!--]--> 缩放变换- scale <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#光源对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="光源对象"><!--[--><!--]--> 光源对象 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#各常见光源对象实践" class="router-link-active router-link-exact-active sidebar-item" aria-label="各常见光源对象实践"><!--[--><!--]--> 各常见光源对象实践 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#光源辅助对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="光源辅助对象"><!--[--><!--]--> 光源辅助对象 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#光照计算算法" class="router-link-active router-link-exact-active sidebar-item" aria-label="光照计算算法"><!--[--><!--]--> 光照计算算法 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#相机" class="router-link-active router-link-exact-active sidebar-item" aria-label="相机"><!--[--><!--]--> 相机 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#阴影计算" class="router-link-active router-link-exact-active sidebar-item" aria-label="阴影计算"><!--[--><!--]--> 阴影计算 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#开启平行光阴影渲染" class="router-link-active router-link-exact-active sidebar-item" aria-label="开启平行光阴影渲染"><!--[--><!--]--> 开启平行光阴影渲染 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#聚光灯阴影计算" class="router-link-active router-link-exact-active sidebar-item" aria-label="聚光灯阴影计算"><!--[--><!--]--> 聚光灯阴影计算 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#光源对象之间的关系" class="router-link-active router-link-exact-active sidebar-item" aria-label="光源对象之间的关系"><!--[--><!--]--> 光源对象之间的关系 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#层级模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="层级模型"><!--[--><!--]--> 层级模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#纹理贴图" class="router-link-active router-link-exact-active sidebar-item" aria-label="纹理贴图"><!--[--><!--]--> 纹理贴图 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#纹理贴图创建" class="router-link-active router-link-exact-active sidebar-item" aria-label="纹理贴图创建"><!--[--><!--]--> 纹理贴图创建 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#球体模型贴图渲染" class="router-link-active router-link-exact-active sidebar-item" aria-label="球体模型贴图渲染"><!--[--><!--]--> 球体模型贴图渲染 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#立方体-贴图渲染" class="router-link-active router-link-exact-active sidebar-item" aria-label="立方体-贴图渲染"><!--[--><!--]--> 立方体-贴图渲染 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#纹理对象-texture" class="router-link-active router-link-exact-active sidebar-item" aria-label="纹理对象-Texture"><!--[--><!--]--> 纹理对象-Texture <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#图片加载器使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="图片加载器使用"><!--[--><!--]--> 图片加载器使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#知识点脑图" class="router-link-active router-link-exact-active sidebar-item" aria-label="知识点脑图"><!--[--><!--]--> 知识点脑图 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#顶点纹理坐标" class="router-link-active router-link-exact-active sidebar-item" aria-label="顶点纹理坐标"><!--[--><!--]--> 顶点纹理坐标 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#uv-坐标" class="router-link-active router-link-exact-active sidebar-item" aria-label="uv 坐标"><!--[--><!--]--> uv 坐标 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#映射" class="router-link-active router-link-exact-active sidebar-item" aria-label="映射"><!--[--><!--]--> 映射 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#nv-坐标的分组" class="router-link-active router-link-exact-active sidebar-item" aria-label="nv 坐标的分组"><!--[--><!--]--> nv 坐标的分组 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#纹理坐标修改" class="router-link-active router-link-exact-active sidebar-item" aria-label="纹理坐标修改"><!--[--><!--]--> 纹理坐标修改 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#层级模型-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="层级模型"><!--[--><!--]--> 层级模型 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#group对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="Group对象"><!--[--><!--]--> Group对象 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#模型对象的删除与添加方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="模型对象的删除与添加方法"><!--[--><!--]--> 模型对象的删除与添加方法 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#层级模型节点的遍历-查找-命名" class="router-link-active router-link-exact-active sidebar-item" aria-label="层级模型节点的遍历，查找，命名"><!--[--><!--]--> 层级模型节点的遍历，查找，命名 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#通过name属性为模型对象添加标记-用来表示子模型对象在整体模型中-所占据的位置。" class="router-link-active router-link-exact-active sidebar-item" aria-label="通过name属性为模型对象添加标记，用来表示子模型对象在整体模型中，所占据的位置。"><!--[--><!--]--> 通过name属性为模型对象添加标记，用来表示子模型对象在整体模型中，所占据的位置。 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#树结构层级模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="树结构层级模型"><!--[--><!--]--> 树结构层级模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#递归遍历算法traverse" class="router-link-active router-link-exact-active sidebar-item" aria-label="递归遍历算法traverse"><!--[--><!--]--> 递归遍历算法traverse <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#模型树节点查找" class="router-link-active router-link-exact-active sidebar-item" aria-label="模型树节点查找"><!--[--><!--]--> 模型树节点查找 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#世界矩阵" class="router-link-active router-link-exact-active sidebar-item" aria-label="世界矩阵"><!--[--><!--]--> 世界矩阵 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#建立世界坐标系概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="建立世界坐标系概念"><!--[--><!--]--> 建立世界坐标系概念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#本地缩放系数" class="router-link-active router-link-exact-active sidebar-item" aria-label="本地缩放系数"><!--[--><!--]--> 本地缩放系数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#本地矩阵和世界矩阵" class="router-link-active router-link-exact-active sidebar-item" aria-label="本地矩阵和世界矩阵"><!--[--><!--]--> 本地矩阵和世界矩阵 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#几何体顶点纹理坐标数据-续" class="router-link-active router-link-exact-active sidebar-item" aria-label="几何体顶点纹理坐标数据(续)"><!--[--><!--]--> 几何体顶点纹理坐标数据(续) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#数组材质和材质索引" class="router-link-active router-link-exact-active sidebar-item" aria-label="数组材质和材质索引"><!--[--><!--]--> 数组材质和材质索引 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#数组材质" class="router-link-active router-link-exact-active sidebar-item" aria-label="数组材质"><!--[--><!--]--> 数组材质 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#材质索引" class="router-link-active router-link-exact-active sidebar-item" aria-label="材质索引"><!--[--><!--]--> 材质索引 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#材质对象texture-的阵列-偏移-选装" class="router-link-active router-link-exact-active sidebar-item" aria-label="材质对象Texture 的阵列，偏移，选装"><!--[--><!--]--> 材质对象Texture 的阵列，偏移，选装 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#阵列" class="router-link-active router-link-exact-active sidebar-item" aria-label="阵列"><!--[--><!--]--> 阵列 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#设置纹理的包裹模式" class="router-link-active router-link-exact-active sidebar-item" aria-label="设置纹理的包裹模式"><!--[--><!--]--> 设置纹理的包裹模式 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#偏移" class="router-link-active router-link-exact-active sidebar-item" aria-label="偏移"><!--[--><!--]--> 偏移 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#纹理旋转" class="router-link-active router-link-exact-active sidebar-item" aria-label="纹理旋转"><!--[--><!--]--> 纹理旋转 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#纹理动画" class="router-link-active router-link-exact-active sidebar-item" aria-label="纹理动画"><!--[--><!--]--> 纹理动画 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#创建设置重复纹理的管道" class="router-link-active router-link-exact-active sidebar-item" aria-label="创建设置重复纹理的管道"><!--[--><!--]--> 创建设置重复纹理的管道 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#画布视频作为纹理贴图" class="router-link-active router-link-exact-active sidebar-item" aria-label="画布视频作为纹理贴图"><!--[--><!--]--> 画布视频作为纹理贴图 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#canvas画布作为纹理贴图-实质是利用2d-api绘制各种形状然后应用到3d网格模型。" class="router-link-active router-link-exact-active sidebar-item" aria-label="canvas画布作为纹理贴图, 实质是利用2D api绘制各种形状然后应用到3D网格模型。"><!--[--><!--]--> canvas画布作为纹理贴图, 实质是利用2D api绘制各种形状然后应用到3D网格模型。 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#凹凸-法线贴图" class="router-link-active router-link-exact-active sidebar-item" aria-label="凹凸，法线贴图"><!--[--><!--]--> 凹凸，法线贴图 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/algorithm/views/theev/base.html#法线贴图" class="router-link-active router-link-exact-active sidebar-item" aria-label="法线贴图"><!--[--><!--]--> 法线贴图 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#凹凸贴图" class="router-link-active router-link-exact-active sidebar-item" aria-label="凹凸贴图"><!--[--><!--]--> 凹凸贴图 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#光照贴图添加阴影" class="router-link-active router-link-exact-active sidebar-item" aria-label="光照贴图添加阴影"><!--[--><!--]--> 光照贴图添加阴影 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#高光贴图" class="router-link-active router-link-exact-active sidebar-item" aria-label="高光贴图"><!--[--><!--]--> 高光贴图 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#环境贴图" class="router-link-active router-link-exact-active sidebar-item" aria-label="环境贴图"><!--[--><!--]--> 环境贴图 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/algorithm/views/theev/base.html#数据纹理贴图" class="router-link-active router-link-exact-active sidebar-item" aria-label="数据纹理贴图"><!--[--><!--]--> 数据纹理贴图 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h2 id="base" tabindex="-1"><a class="header-anchor" href="#base" aria-hidden="true">#</a> Base</h2><h3 id="顶点概念" tabindex="-1"><a class="header-anchor" href="#顶点概念" aria-hidden="true">#</a> 顶点概念</h3><h4 id="类型数组" tabindex="-1"><a class="header-anchor" href="#类型数组" aria-hidden="true">#</a> 类型数组</h4><blockquote><p>类型数组使用 int, unit[Bit]来表示，区别于普通数组。普通数组使用[]或 Array 构造创建.</p><blockquote><p>普通数组对待数字处理一般分为有符号 32 位整形数据和 64 位浮点数。类型数组之所以有类型这个定语，就是因为每一个构造函数对应一种 number 类型里面细分的数据类型。</p></blockquote><blockquote><p>Javascript 一般情况处理整数只有一种整型模式，一个整型数据分配 32 位内存空间， 类型数组中，构造函数 Int8Array()创建的数组每个元素占据的内存是 8 位，正如其名前半部分 Int8； Int16Array()创建数组的数字元素分配内存分配 16 位，诸如其他的构造函数 Float32Array 、 Float64Array、Int32Array 根据名字都知道它的元素类型和元素分配的内存空间。</p></blockquote></blockquote><h4 id="几种不同数组创建方式对应的内存分配图" tabindex="-1"><a class="header-anchor" href="#几种不同数组创建方式对应的内存分配图" aria-hidden="true">#</a> 几种不同数组创建方式对应的内存分配图</h4><ol><li>[] 或 Array, 普通数组创建</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>数组元素内存分配，每一个元素占用 32 为内存空间. 如下，是数组 arr[0] = 10</p><img src="/algorithm/assets/array.294f00e0.png"><ol start="2"><li>arr2 = new Uint16Array([10,12,13]);</li></ol><p>使用无符号 16 位类型数组创建数组，如下是 arr2[0] = 10 内存分配。 <img src="/algorithm/assets/uinit.9cfdf5e9.png"></p><ol start="3"><li>arr3 = new Uint8Array([10,12,13]);</li></ol><p>使用无符号 8 位类型数组， 每一个数组元素分配 8 s 位内存空间 <img src="/algorithm/assets/unit8.80c39994.png"></p><h3 id="类型数组构造函数表" tabindex="-1"><a class="header-anchor" href="#类型数组构造函数表" aria-hidden="true">#</a> 类型数组构造函数表</h3><img src="/algorithm/assets/typearray.9fe7c01b.png"><blockquote><p>Int 来自单词 integer 整数，无符号的 U 来自单词 Unsigned 无符号，整型对应的就是整数，浮点数你可以简单的理解位小数，整数分为整数有正数和负数之分。 无符号整数不能用来表示负数，内存的存储不要要符号位，有符号自然包括负数，<strong>正数分配的最小存储单元第一位会用来作为符号位，0 表示正数，1 表示复数。</strong></p></blockquote><h3 id="类型数组属性" tabindex="-1"><a class="header-anchor" href="#类型数组属性" aria-hidden="true">#</a> 类型数组属性</h3><blockquote><p>类型数组和普通数组一样都是对象，也一样具有属性，类型数组有些属性是独有属性，有些属性和普通数组一样</p></blockquote><ul><li>BYTES_PER_ELEMENT, 获取类型数组元素占用内存空间</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> data1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Int16Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> size1 <span class="token operator">=</span> data1<span class="token punctuation">.</span><span class="token constant">BYTES_PER_ELEMENT</span><span class="token punctuation">;</span> <span class="token comment">//返回结果size1为4</span>
<span class="token keyword">let</span> size2 <span class="token operator">=</span> data2<span class="token punctuation">.</span><span class="token constant">BYTES_PER_ELEMENT</span><span class="token punctuation">;</span> <span class="token comment">//返回结果size2为2</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>byteLength, 获取类型数组暂占用内存总数(Byte)</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> data1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Int16Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> bL1 <span class="token operator">=</span> data1<span class="token punctuation">.</span>byteLength<span class="token punctuation">;</span> <span class="token comment">//返回结果20</span>
<span class="token keyword">let</span> bL2 <span class="token operator">=</span> data2<span class="token punctuation">.</span>byteLength<span class="token punctuation">;</span> <span class="token comment">//返回结果10</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>length, 获取类型数组对象内涵元素个数</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> data1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Int16Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token constant">L1</span> <span class="token operator">=</span> data1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token comment">//返回结果5</span>
<span class="token keyword">let</span> <span class="token constant">L2</span> <span class="token operator">=</span> data2<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token comment">//返回结果5</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="类型数组属性对照表" tabindex="-1"><a class="header-anchor" href="#类型数组属性对照表" aria-hidden="true">#</a> 类型数组属性对照表</h3><table><thead><tr><th>属性</th><th>含义</th></tr></thead><tbody><tr><td>BYTES-PER-ELEMENT</td><td>构造函数创建的数组里面元素分配的字内存字节数</td></tr><tr><td>bytelength</td><td>数组所有元素占用的内存空间，单位：字节 B</td></tr><tr><td>length</td><td>数组内含元素个数</td></tr></tbody></table><h3 id="类型数组方法" tabindex="-1"><a class="header-anchor" href="#类型数组方法" aria-hidden="true">#</a> 类型数组方法</h3><table><thead><tr><th>方法</th><th>含义</th></tr></thead><tbody><tr><td>get(index)</td><td>index 是整数值 0、1、2，表示类型数组元素的索引，执行方法返回索引 index 对应的元素值</td></tr><tr><td>set(index, value)</td><td>更改类型数组索引 index 对应的元素值为 value</td></tr><tr><td>set(array,offset)</td><td>给类型数组 array 插入元素，插入位置是偏移 offset 个元素</td></tr></tbody></table><h3 id="类型数组视图内存分配对比" tabindex="-1"><a class="header-anchor" href="#类型数组视图内存分配对比" aria-hidden="true">#</a> 类型数组视图内存分配对比</h3><img src="https://mdn.mozillademos.org/files/8629/typed_arrays.png"><h2 id="顶点" tabindex="-1"><a class="header-anchor" href="#顶点" aria-hidden="true">#</a> 顶点</h2><h3 id="顶点法向量" tabindex="-1"><a class="header-anchor" href="#顶点法向量" aria-hidden="true">#</a> 顶点法向量</h3><h3 id="漫反射-镜面反射" tabindex="-1"><a class="header-anchor" href="#漫反射-镜面反射" aria-hidden="true">#</a> 漫反射，镜面反射.</h3><blockquote><p>漫反射，是投射在粗糙表面上的光向各个方向反射的现象。当一束平行的入射光线射到粗糙的表面时，表面会把光线向着四面八方反射，所以入射线虽然互相平行，由于各点的法线方向不一致，造成反射光线向不同的方向无规则地反射，这种反射称之为“漫反射”或“漫射”。这种反射的光称为漫射光。很多物体，如植物、墙壁、衣服等，其表面粗看起来似乎是平滑，但用放大镜仔细观察，就会看到其表面是凹凸不平的，所以本来是平行的太阳光被这些表面反射后，弥漫地射向不同方向</p></blockquote><blockquote><p>镜面反射是指若反射面比较光滑，当平行入射的光线射到这个反射面时，仍会平行地向一个方向反射出来，这种反射就属于镜面反射 [</p></blockquote><blockquote><p>法线（normal line），是指始终垂直于某平面的直线。在几何学中，法线指平面上垂直于曲线在某点的切线的一条线。法线也应用于光学的平面镜反射上。</p></blockquote><blockquote><p>WebGl 中，为了计算光线与物体表面的入射角，需要先计算物体表面法向量。在 Threejs 中表示物体的网格模型 Mesh 的曲面是由一个一个三角形构成，所以为了表示物体表面各个位置的法线方向，可以给几何体的每个顶点定义一个方向向量。 threejs 三维空间，物体坐标表示(y, z, x)</p></blockquote><p>确认法向量过后，开始为场景加入光源。此时环境光和点光源都会参与光照计算。构建几何体表面的三角形整个表面比较明亮，同时两个三角形表面法线不同，即使光线方向相同，明暗自然不同，在分界位置有棱角感。</p><blockquote><p>高光效果是镜面反射的形成。平行光线从入射到高光材质表面完全反射出去，材质表面表现高光效果。</p></blockquote><h3 id="顶点索引自定义实现立方体" tabindex="-1"><a class="header-anchor" href="#顶点索引自定义实现立方体" aria-hidden="true">#</a> 顶点索引自定义实现立方体</h3><blockquote><p>通过缓冲几何体，自定义设置顶点数据，来实现几何体.</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span>
  <span class="token number">50</span><span class="token punctuation">,</span>
  window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span>
  <span class="token number">0.1</span><span class="token punctuation">,</span>
  <span class="token number">1000</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>

<span class="token comment">// 加入光源</span>
<span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PointLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
point<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> ambient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AmbientLight</span><span class="token punctuation">(</span><span class="token number">0xbb7777</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ambient<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 空buffer几何体</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>geometry<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 定义顶点数据</span>

<span class="token keyword">let</span> vertices <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// y -&gt; 轴面</span>

  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment">// x-&gt; 轴面</span>

  <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment">// x-y -&gt; 轴</span>

  <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment">// y-&gt;y 轴</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 顶点法向量定义</span>
<span class="token comment">// 法向量的点，是通过顶点做垂直于网格模型平面的垂直线.</span>
<span class="token keyword">let</span> normals <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>

  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>

  <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>

  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>

  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>

  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> colors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点1颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点2颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶点3颜色</span>

  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点4颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶点5颜色</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶 6</span>

  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点1颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点2颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶点3颜色</span>

  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点4颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶点5颜色</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶 6</span>

  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点1颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点2颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶点3颜色</span>

  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点4颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶点5颜色</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶 6</span>

  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点1颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点2颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶点3颜色</span>

  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//顶点4颜色</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶点5颜色</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//顶 6s</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义顶点索引</span>
<span class="token keyword">let</span> indexs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint16Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

geometry<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;position&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferAttribute</span><span class="token punctuation">(</span>vertices<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
geometry<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;normal&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferAttribute</span><span class="token punctuation">(</span>normals<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//   geometry.setAttribute(&quot;color&quot;, new THREE.BufferAttribute(colors, 3));</span>
geometry<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferAttribute</span><span class="token punctuation">(</span>indexs<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 面渲染模型</span>
<span class="token comment">// 定义材质</span>
<span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// vertexColors: THREE.VertexColors,</span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x777777</span><span class="token punctuation">,</span>
  <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 空间坐标辅助对象</span>
<span class="token keyword">let</span> axesHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AxesHelper</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>axesHelper<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> controls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>OrbitControls</span><span class="token punctuation">(</span>camera<span class="token punctuation">,</span> renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
controls<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span> render<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>通过 API<code> Gemotry</code>同样，也可以实现缓冲几何体.不过在 threejsr125 版本过后，已经移除对此 api 支持。</p></div><h3 id="buffergemotry-总结" tabindex="-1"><a class="header-anchor" href="#buffergemotry-总结" aria-hidden="true">#</a> BufferGemotry 总结</h3><img src="http://assets.processon.com/chart_image/61b8c6497d9c0868e020ead4.png"><h3 id="几何体对象数据访问" tabindex="-1"><a class="header-anchor" href="#几何体对象数据访问" aria-hidden="true">#</a> 几何体对象数据访问</h3><blockquote><p>包括，顶点，颜色，顶点法向量数据。threejs 内置的几何体模型，已经封装好，可以直接访问对象属性，查看属性。</p></blockquote><h4 id="访问外部模型几何体顶点数据" tabindex="-1"><a class="header-anchor" href="#访问外部模型几何体顶点数据" aria-hidden="true">#</a> 访问外部模型几何体顶点数据</h4><blockquote><p>实际开发项目的时候，可能会加载外部模型，有些时候需要获取模型几何体的顶点数据 Threejs 加载外部模型的时候，会把几何体解析为缓冲类型几何体 BufferGeometry，所以访问外部模型几何体顶点数据</p></blockquote><h2 id="材质对象" tabindex="-1"><a class="header-anchor" href="#材质对象" aria-hidden="true">#</a> 材质对象</h2><blockquote><p>材质对象是包含光照算法的 着色器 GLSL,ES 代码。目的在于赋予模型外观上的改变。比如模型的金属，透明度等模型外观。都是着色器的运用。为了方便开发 Threejs 提供了一系列的材质，所有材质就是对 WebGL 着色器代码的封装</p></blockquote><p><strong>材质相关 API 总结</strong></p><img src="/algorithm/assets/material.c0f363fe.png"><h3 id="材质对象和模型对象对应关系" tabindex="-1"><a class="header-anchor" href="#材质对象和模型对象对应关系" aria-hidden="true">#</a> 材质对象和模型对象对应关系</h3><img src="/algorithm/assets/modalandmaterial.ee48657d.png"><h2 id="模型对象" tabindex="-1"><a class="header-anchor" href="#模型对象" aria-hidden="true">#</a> 模型对象</h2><blockquote><p>模型对象在 threejs 角度来说，就是有几何体与材质对象结合形成的三维对象。其中，材质设置三维模型外观形状，几何体则通过顶点坐标数据来表达三维模型外观形状。</p></blockquote><p><strong>常用模型对象</strong></p><ul><li>Mesh,网格模型。</li><li>Point,点模型</li><li>Line, 线模型。</li></ul><img src="/algorithm/assets/3dModal.9ed2f17c.png"><p><em>Line,Mesh, Point 以及对应的材质都是由基类 BufferGeometry, Material 构成</em></p><h3 id="点模型" tabindex="-1"><a class="header-anchor" href="#点模型" aria-hidden="true">#</a> 点模型</h3><blockquote><p>点模型就是几何体顶点数据所渲染的一个像素区域</p></blockquote><h3 id="线模型" tabindex="-1"><a class="header-anchor" href="#线模型" aria-hidden="true">#</a> 线模型</h3><blockquote><p>通过顶点数据绘制线条</p></blockquote><ul><li>Line, 线</li><li>LineLoop, 首位相连线</li></ul><h3 id="网格模型" tabindex="-1"><a class="header-anchor" href="#网格模型" aria-hidden="true">#</a> 网格模型</h3><blockquote><p>结合顶点数据，以三角形为基本平面绘制几何体</p></blockquote><h3 id="模型对象变换" tabindex="-1"><a class="header-anchor" href="#模型对象变换" aria-hidden="true">#</a> 模型对象变换</h3><blockquote><p>点模型 Points、线模型 Line、网格网格模型 Mesh 等模型对象的基类都是 Object3D. 若想对模型对象平移变换,通过使用基类的集成属性或者方法操作.</p></blockquote><img src="/algorithm/assets/modalchange.5d932fc4.png"><h4 id="缩放变换-scale" tabindex="-1"><a class="header-anchor" href="#缩放变换-scale" aria-hidden="true">#</a> 缩放变换- scale</h4><blockquote><p>模型对象的缩放属性<code>scale</code>,控制模型的缩放比列. 此属性的值是一个三维矢量数据。使用三维矢量构造 THREE.Vector3 来设置。三维矢量构造方法<code>set</code>用于更新三维矢量。</p></blockquote><p><strong>scale</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token constant">THREE</span><span class="token punctuation">.</span>Vector3<span class="token punctuation">;</span>
<span class="token comment">// 三个参数是向量三维空间坐标表示</span>
<span class="token function">set</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用</span>
mesh<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * x轴缩放 0.5,
 * y轴缩放 1.5
 * z轴缩放 2
 *
 *
 */</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>position</strong></p><blockquote><p>模型位置.position 属性和.scale 属性的属性值一样也是三维向量对象 Vector3，通过模型位置属性.position 可以设置模型在场景 Scene 中的位置。模型位置.position 的默认值是 THREE.Vector3(0.0,0.0,0.0)。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 此位置设置模型在场景中的位置</span>
<span class="token comment">// 设置模型xyz坐标;</span>
mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x-80, y-2, z- 10</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>tranlate-X/Y/Z</strong></p><blockquote><p>网格模型沿着 x 轴正方向平移 100，可以多次执行该语句，每次执行都是相对上一次的位置进行平移变换。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 等价于 mesh.position = mesh.position + 100;</span>
mesh<span class="token punctuation">.</span><span class="token function">translateX</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//沿着 x 轴正方向平移距离 100</span>
沿着 <span class="token constant">Z</span> 轴负方向平移距离 <span class="token number">50</span>。

mesh<span class="token punctuation">.</span><span class="token function">translateZ</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//沿着自定义的方向移动。</span>
<span class="token comment">//向量 Vector3 对象表示方向</span>
<span class="token keyword">var</span> axis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
axis<span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//向量归一化</span>
<span class="token comment">//沿着 axis 轴表示方向平移 100</span>
mesh<span class="token punctuation">.</span><span class="token function">translateOnAxis</span><span class="token punctuation">(</span>axis<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>执行.translateX()、.translateY()、.translateOnAxis()等方法本质上改变的都是模型的位置属性.position。</p></div><p><strong>rotateX/Y/Z</strong></p><blockquote><p>立方体网格模型绕立方体的 x/y/z 轴旋转 π/4，可以多次执行该语句，每次执行都是相对上一次的角度进行旋转变化</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 绕x轴旋转 PI/4</span>
mesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 自定义旋转轴旋转</span>
<span class="token comment">// 网格模型绕(0,1,0)向量表示的轴旋转π/8</span>
<span class="token keyword">var</span> axis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//向量axis</span>
mesh<span class="token punctuation">.</span><span class="token function">rotateOnAxis</span><span class="token punctuation">(</span>axis<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//绕axis轴旋转π/8</span>

<span class="token comment">// 绕着Y轴旋转90度</span>
mesh<span class="token punctuation">.</span><span class="token function">rotateY</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//控制台查看：旋转方法，改变了rotation属性</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mesh<span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>执行旋转.rotateX()等方法和执行平移.translateY()等方法一样都是对模型状态属性的改变，区别在于执行平移方法改变的是模型的位置属性.position，执行模型的旋转方法改变的是表示模型角度状态的角度属性.rotation 或者四元数属性.quaternion。</p><p>模型的角度属性.rotation 和四元数属性.quaternion 都是表示模型的角度状态，只是表示方法不同，.rotation 属性值是欧拉对象 Euler,.quaternion 属性值是是四元数对象 Quaternion</p></div><p><strong>旋转属性总结</strong></p><ul><li>rotation, 模型的角度属性</li><li>quaternion, 四元数属性</li><li>rotateX/Y/Z, 控制模型旋转</li></ul><h2 id="光源对象" tabindex="-1"><a class="header-anchor" href="#光源对象" aria-hidden="true">#</a> 光源对象</h2><blockquote><p>threejs 三维场景对象<code>Scene</code>主要由，模型对象和光源对象构成.</p></blockquote><img src="http://assets.processon.com/chart_image/61b8c6497d9c0868e020ead4.png"><h3 id="各常见光源对象实践" tabindex="-1"><a class="header-anchor" href="#各常见光源对象实践" aria-hidden="true">#</a> 各常见光源对象实践</h3><blockquote><p>threejs 虚拟光源是对自然界光源的模糊，为了更好渲染虚拟场景，需要设置好光源.</p></blockquote><ul><li><strong>环境光</strong></li></ul><blockquote><p>环境光即是自然光的模拟.环境光照射在物体表面时，物体表面各个方向的明暗程度一致.</p></blockquote><div class="custom-container tip"><p class="custom-container-title">提示</p><p>环境光的颜色计算方式是和物体的材质颜色相乘计算的。</p></div><ul><li><strong>点光源</strong></li></ul><blockquote><p>点光源模拟，类似生活中的白炽灯。光线从光源核心处向外扩散。当光线投射到物体平面时，光线与物体表面的入射角不一致。因此物体表面的明暗程度也就不相同；同时也受远近影响光线衰弱程度不同。 与平行光不同，在使用点光源时，需要设置 Light 的位置<code>position</code>属性。</p></blockquote><ul><li><strong>平行光</strong></li></ul><blockquote><p>平行光顾名思义光线平行，对于一个平面而言，平面不同区域接收到平行光的入射角一样。点光源因为是向四周发散，所以设置好位置属性.position 就可以确定光线和物体表面的夹角，对于平行光而言,主要是确定光线的方向,光线方向设定好了，光线的与物体表面入射角就确定了，仅仅设置光线位置是不起作用的。 在三维空间中为了确定一条直线的方向只需要确定直线上两个点的坐标即可，所以 Threejs 平行光提供了位置.position 和目标.target 两个属性来一起确定平行光方向 目标.target 的属性值可以是 Threejs 场景中任何一个三维模型对象，比如一个网格模型 Mesh，这样 Threejs 计算平行光照射方向的时候，会通过自身位置属性.position 和.target 表示的物体的位置属性.position 计算出来。</p></blockquote><p><em>平行光如果不设置.position 和.target 属性，光线默认从上往下照射，也就是可以认为(0,1,0)和(0,0,0)两个坐标确定的光线方向。</em></p><div class="custom-container tip"><p class="custom-container-title">提示</p><p>平行光的<code>position</code>属性并不表示物体的发射起点。而是用来确定光线的方向用的。平行光的发射起点可以从太阳光想象，即是从远处沿指定方向投射来。</p></div><ul><li><strong>聚光灯</strong></li></ul><blockquote><p>聚光源可以认为是一个沿着特定方会逐渐发散的光源，照射范围在三维空间中构成一个圆锥体。通过属性.angle 可以设置聚光源发散角度，聚光源照射方向设置和平行光光源一样是通过位置.position 和目标.target 两个属性来实现。</p></blockquote><h3 id="光源辅助对象" tabindex="-1"><a class="header-anchor" href="#光源辅助对象" aria-hidden="true">#</a> <strong>光源辅助对象</strong></h3><table><thead><tr><th>辅助对象</th><th>构造</th></tr></thead><tbody><tr><td>聚光源辅助</td><td>SpotLightHelper</td></tr><tr><td>点光源辅助</td><td>PointLightHelper</td></tr><tr><td>平行光光源辅助</td><td>DirectionalHelper</td></tr></tbody></table><h3 id="光照计算算法" tabindex="-1"><a class="header-anchor" href="#光照计算算法" aria-hidden="true">#</a> 光照计算算法</h3><blockquote><p>Threejs 在渲染的时候网格模型材质的颜色值 mesh.material.color 和光源的颜色值 light.color 会进行相乘，简单说就是 RGB 三个分量分别相乘。 数学模型为: 漫反射光的颜色 = 网格模型材质颜色值 x 光线颜色 x 光线入射角余弦值 光照颜色计算最后颜色，就是光线透过物体，反射后的颜色。也就是最终反馈给肉眼的颜色。</p></blockquote><p><em>漫反射颜色计算公式: (R2, G2, B2) = (R1, G1, B1) x (R0, G0, B0) x cosθ</em></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token constant">R2</span> <span class="token operator">=</span> <span class="token constant">R1</span> <span class="token operator">*</span> <span class="token constant">R0</span> <span class="token operator">*</span> cosθ<span class="token punctuation">;</span>
<span class="token constant">G2</span> <span class="token operator">=</span> <span class="token constant">G1</span> <span class="token operator">*</span> <span class="token constant">G0</span> <span class="token operator">*</span> cosθ<span class="token punctuation">;</span>
<span class="token constant">B2</span> <span class="token operator">=</span> <span class="token constant">B1</span> <span class="token operator">*</span> <span class="token constant">B0</span> <span class="token operator">*</span> cosθ<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>白色可以反射任意光线。材质本身颜色。并不是真正反馈给肉眼的，而是通过光线反馈给肉眼。比如一个黑色的物体，在蓝色光线下，会表现蓝色效果。</p></div><h2 id="相机" tabindex="-1"><a class="header-anchor" href="#相机" aria-hidden="true">#</a> 相机</h2><p>相关概念:</p><p><a href="https://blog.csdn.net/zipack/article/details/114384862" target="_blank" rel="noopener noreferrer">透视与正交<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="阴影计算" tabindex="-1"><a class="header-anchor" href="#阴影计算" aria-hidden="true">#</a> 阴影计算</h2><blockquote><p>通过设置不同的光源对象，来开启模型在场景的阴影渲染</p></blockquote><h3 id="开启平行光阴影渲染" tabindex="-1"><a class="header-anchor" href="#开启平行光阴影渲染" aria-hidden="true">#</a> 开启平行光阴影渲染</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 如果不开启阴影，则不会渲染阴影</span>
renderer<span class="token punctuation">.</span>shadowMap<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 关键点4，</span>
renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span><span class="token function">setClearColor</span><span class="token punctuation">(</span><span class="token number">0x888888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x0000ff</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 设置产生投影的网格模型</span>
mesh<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 关键点1</span>
mesh<span class="token punctuation">.</span>receiveShadow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">//创建一个平面几何体作为投影面</span>
<span class="token keyword">let</span> planeGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PlaneGeometry</span><span class="token punctuation">(</span>
  window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span>
  window<span class="token punctuation">.</span>innerHeight
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> planeMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xffffff</span><span class="token punctuation">,</span>
  <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> planeMesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>planeGeometry<span class="token punctuation">,</span> planeMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>planeMesh<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//网格模型添加到场景中</span>
planeMesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//旋转网格模型</span>
planeMesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">//设置网格模型y坐标</span>
<span class="token comment">// 设置接收阴影的投影面, 关键点2</span>
planeMesh<span class="token punctuation">.</span>receiveShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// 方向光</span>
<span class="token keyword">let</span> directionalLight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>DirectionalLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置光源位置</span>
directionalLight<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>directionalLight<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置用于计算阴影的光源对象, 关键点 3</span>
directionalLight<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">// 设置计算阴影的区域，最好刚好紧密包围在对象周围</span>
<span class="token comment">// 计算阴影的区域过大：模糊  过小：看不到或显示不完整</span>
<span class="token comment">// shadow属性camera定义场景中模型的深度图，即模型阴影</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>near <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>far <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">;</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>bottom <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p>设置阴影的关键点:</p><ol><li>启用渲染器的阴影渲染</li><li>设置渲染器的相机类型.</li><li>设置阴影用的模型</li><li>设置接收阴影的模型</li><li>设置光源休息,用来投射阴影</li></ol><h3 id="聚光灯阴影计算" tabindex="-1"><a class="header-anchor" href="#聚光灯阴影计算" aria-hidden="true">#</a> 聚光灯阴影计算</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xff0000</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 设置产生投影的网格模型</span>
mesh<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 关键点1</span>
mesh<span class="token punctuation">.</span>receiveShadow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">//创建一个平面几何体作为投影面</span>
<span class="token keyword">let</span> planeGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PlaneGeometry</span><span class="token punctuation">(</span>
  window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span>
  window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span>
  <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token number">20</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//   let planeMaterial = new THREE.MeshPhongMaterial({</span>
<span class="token comment">//     color: 0x00ff00,</span>
<span class="token comment">//   });</span>
<span class="token keyword">let</span> planeMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ff00</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> planeMesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>planeGeometry<span class="token punctuation">,</span> planeMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>planeMesh<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//网格模型添加到场景中</span>
planeMesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//旋转网格模型</span>
planeMesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">//设置网格模型y坐标</span>
<span class="token comment">// 设置接收阴影的投影面, 关键点2</span>
planeMesh<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
planeMesh<span class="token punctuation">.</span>receiveShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// 方向光</span>
<span class="token keyword">var</span> spotLight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SpotLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置聚光光源位置</span>
spotLight<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置聚光光源发散角度</span>
spotLight<span class="token punctuation">.</span>angle <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>spotLight<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//光对象添加到scene场景中</span>
<span class="token comment">// 设置用于计算阴影的光源对象</span>
spotLight<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">// 设置计算阴影的区域，注意包裹对象的周围</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>mapSize<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>mapSize<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>near <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>far <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">;</span>
<span class="token comment">//   spotLight.shadow.camera.fov = 20;</span>

<span class="token comment">// 定义阴影的尺寸</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>mapSize<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>mapSize<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">,</span> spotLight<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CameraHelper</span><span class="token punctuation">(</span>spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>helper<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> spotLightHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SpotLightHelper</span><span class="token punctuation">(</span>spotLight<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>spotLightHelper<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>要点:</p><blockquote><p>同平行光一样，聚光灯的阴影计算需要开启材质表面的精度。如上面的几何平面模型，需要开启水平 x,y 的分段系数。由于采用的材质模拟的物理表面不具有高光效果。并且是非光泽平面。</p></blockquote><p>计算阴影相关</p><table><thead><tr><th>属性</th><th>作用</th></tr></thead><tbody><tr><td>castShadow</td><td>castShadow 属性值是布尔值，默认 false，用来设置一个模型对象是否在光照下产生投影效果</td></tr><tr><td>receiveShadow</td><td>receiveShadow 属性值是布尔值，默认 false，用来设置一个模型对象是否在光照下接受其它模型的投影效果</td></tr><tr><td>光源.castShadow</td><td>如果属性设置为 true， 光源将投射动态阴影. 警告: 这需要很多计算资源，需要调整以使阴影看起来正确.</td></tr><tr><td>光源.shadow 属性</td><td>平行光 DirectionalLight 的.shadow 属性值是平行光阴影对象 DirectionalLightShadow，聚光源 SpotLight 的.shadow 属性值是聚光源阴影对象 SpotLightShadow</td></tr><tr><td>阴影对象基类 LightShadow</td><td>平行光阴影对象 DirectionalLightShadow 和聚光源阴影对象 SpotLightShadow 两个类的基类是 LightShadow</td></tr></tbody></table><p>阴影对象属性:</p><ol><li>.camera: 观察光源的相机对象. 从光的角度来看，以相机对象的观察位置和方向来判断，其他物体背后的物体将处于阴影中。</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>near <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 视椎体近端面</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>far <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span> <span class="token comment">// 视椎体远端面</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>fov <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// 垂直视椎体距离</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>.mapSize 定义阴影纹理贴图宽高尺寸的一个二维向量 Vector2.较高的值会以计算时间为代价提供更好的阴影质量. 宽高分量值必须是 2 的幂, 直到给定设备的 WebGLRenderer.capabilities.maxTextureSize. 默认, (512, 512)</li><li>map: 该属性的值是 WebGL 渲染目标对象 WebGLRenderTarget，使用内置摄像头生成的深度图; 超出像素深度的位置在阴影中。 在渲染期间内部计算。</li></ol><h3 id="光源对象之间的关系" tabindex="-1"><a class="header-anchor" href="#光源对象之间的关系" aria-hidden="true">#</a> 光源对象之间的关系</h3><p><strong>光源颜色.color 与光强度.indentisty</strong></p><blockquote><p>光照在计算时，会计算两个值的乘积。因此调整光照强度，也可以从颜色或者光照强度单方面调整。</p></blockquote><img src="/algorithm/assets/light.01ac6767.png"><h2 id="层级模型" tabindex="-1"><a class="header-anchor" href="#层级模型" aria-hidden="true">#</a> 层级模型</h2><h2 id="纹理贴图" tabindex="-1"><a class="header-anchor" href="#纹理贴图" aria-hidden="true">#</a> 纹理贴图</h2><blockquote><p>纹理贴图是 Threejs 一个很重要的内容，游戏、产品 720 展示、物联网 3D 可视化等项目程序员加载模型的同时需要处理纹理贴图。</p></blockquote><p>纹理贴图类型:</p><img src="/algorithm/assets/textTure.7ad46332.png"><h3 id="纹理贴图创建" tabindex="-1"><a class="header-anchor" href="#纹理贴图创建" aria-hidden="true">#</a> 纹理贴图创建</h3><blockquote><p>纹理贴图创建通过纹理贴图加载器加载一张图片，可以返回一个纹理对象 Texture.纹理对象 Texture 可以作为模型材质颜色贴图.map 属性的值。设置材质颜色的 map 属性后，不需要再设置材质颜色。网格模型会获取纹理贴图的 RGB 值。设置到模型上。</p></blockquote><p>不同模型具有不同的 uv 坐标来设置贴图和模型的映射规律</p><p><strong>面模型渲染贴图</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ...</span>
<span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PlaneGeometry</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> textureLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>
  <span class="token string">&quot;./static/earth.jpeg&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">texture</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span>
      <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> planmesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
    planmesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//   planmesh.position.y = -200;</span>
    scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>planmesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 加载成功过后，从新调用render渲染</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="球体模型贴图渲染" tabindex="-1"><a class="header-anchor" href="#球体模型贴图渲染" aria-hidden="true">#</a> 球体模型贴图渲染</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> textureLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>
  <span class="token string">&quot;./static/earth.jpeg&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">texture</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span>
      <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> planmesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
    planmesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//   planmesh.position.y = -200;</span>
    scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>planmesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 加载成功过后，从新调用render渲染</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="立方体-贴图渲染" tabindex="-1"><a class="header-anchor" href="#立方体-贴图渲染" aria-hidden="true">#</a> 立方体-贴图渲染</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> textureLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>
  <span class="token string">&quot;./static/earth.jpeg&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">texture</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span>
      <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> planmesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
    planmesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//   planmesh.position.y = -200;</span>
    scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>planmesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 加载成功过后，从新调用render渲染</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="纹理对象-texture" tabindex="-1"><a class="header-anchor" href="#纹理对象-texture" aria-hidden="true">#</a> 纹理对象-Texture</h4><div class="custom-container tip"><p class="custom-container-title">提示</p><p>通过图片加载器 ImageLoader 可以加载一张图片，所谓纹理对象 Texture 简单地说就是，纹理对象 Texture 的.image 属性值是一张图片。</p></div><p>使用图片加载器加载图片，并创建图片贴图.</p><h4 id="图片加载器使用" tabindex="-1"><a class="header-anchor" href="#图片加载器使用" aria-hidden="true">#</a> 图片加载器使用</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> imgLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>ImageLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用加载器加载图片</span>
imgLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>
  <span class="token string">&quot;./static/earth.jpeg&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">img</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> texture <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Texture</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用贴图对象基类创建贴图</span>

    <span class="token comment">// 设置贴图更新</span>
    texture<span class="token punctuation">.</span>needsUpdate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span>
      <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> planmesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
    planmesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//   planmesh.position.y = -200;</span>
    scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>planmesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 加载成功过后，从新调用render渲染</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>归纳： 上面例子使用图片加载器加载图片，然后使用纹理对象,使用图片手动构架纹理贴图。涉及 api 知识点</p><ol><li>ImageLoader, 加载图片，用来生成纹理</li><li>Texture, 创建图片贴图</li><li>异步图片加载</li></ol><h4 id="知识点脑图" tabindex="-1"><a class="header-anchor" href="#知识点脑图" aria-hidden="true">#</a> 知识点脑图</h4><img src="/algorithm/assets/texture.2855ebe6.png"><h2 id="顶点纹理坐标" tabindex="-1"><a class="header-anchor" href="#顶点纹理坐标" aria-hidden="true">#</a> 顶点纹理坐标</h2><blockquote><p>uv 贴图坐标用来与纹理贴图做映射用，设置模型纹理。此知识点探究 uv 坐标和纹理贴图的映射关系。</p></blockquote><p>知识点脑图:</p><img src="/algorithm/assets/uv-position.d7dc919f.png"><h3 id="uv-坐标" tabindex="-1"><a class="header-anchor" href="#uv-坐标" aria-hidden="true">#</a> uv 坐标</h3><blockquote><p>几何体的构成，由顶点数据所形成的三角形面，无数的面来构成几何体。而 uv 坐标就是这个面上的点，二维平面坐标。</p></blockquote><h3 id="映射" tabindex="-1"><a class="header-anchor" href="#映射" aria-hidden="true">#</a> 映射</h3><blockquote><p>纹理 UV 坐标和顶点位置坐标是一一对应关系，这也就是为什么一张图片可以映射到一个模型的表面，只要把图片的每个纹理坐标和模型的顶点位置建立一对一的关系，就可以实现图像到模型的映射。</p></blockquote><p>纹理映射:</p><img src="/algorithm/assets/nvtopostion.e87f9e6b.png"><h3 id="nv-坐标的分组" tabindex="-1"><a class="header-anchor" href="#nv-坐标的分组" aria-hidden="true">#</a> nv 坐标的分组</h3><ol><li>几何体有两组 UV 坐标，第一组组用于.map、.normalMap、.specularMap 等贴图的映射</li><li>第二组用于阴影贴图.lightMap 的映射</li></ol><h3 id="纹理坐标修改" tabindex="-1"><a class="header-anchor" href="#纹理坐标修改" aria-hidden="true">#</a> 纹理坐标修改</h3><blockquote><p>uv 坐标是二位矢量. threejs 中，通过 Vector2 设置. 设置几何体贴图时，根据 uv 坐标和几何体顶点的坐标映射。来完成面贴图设置。</p></blockquote><p><strong>获取 uv 坐标</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 这里假设获取立方体的uv坐标</span>
<span class="token keyword">let</span> gemotry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> uv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> uvAttribute <span class="token operator">=</span> gemotry<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;uv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//遍历获取每个面的uv坐标点</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> uvAttribute<span class="token punctuation">.</span>count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  uv<span class="token punctuation">.</span><span class="token function">fromBufferAttribute</span><span class="token punctuation">(</span>uvAttribute<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回平面的每个顶点uv坐标</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>更新 uv 坐标</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> faceUV <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> uvAttribute<span class="token punctuation">.</span>count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  faceUV <span class="token operator">=</span> uv<span class="token punctuation">.</span><span class="token function">fromBufferAttribute</span><span class="token punctuation">(</span>uvAttribute<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回平面的每个顶点uv坐标</span>
<span class="token punctuation">}</span>
uvAttribute<span class="token punctuation">.</span><span class="token function">setXY</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> faceUV<span class="token punctuation">.</span>x<span class="token punctuation">,</span> faceUV<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="层级模型-1" tabindex="-1"><a class="header-anchor" href="#层级模型-1" aria-hidden="true">#</a> 层级模型</h2><blockquote><p>场景的模型对象，就是由一个个单一模型组合而成。参照html的元素构建的dom数。threejs中的模型也是由一个个模型对象构成的，这些单一的模型可以通过id或name去选择。threejs中，通过group去组织各个模型。</p></blockquote><p>知识点脑图:</p><img src="/algorithm/assets/group.91bcced4.png"><h3 id="group对象" tabindex="-1"><a class="header-anchor" href="#group对象" aria-hidden="true">#</a> Group对象</h3><blockquote><p>通过Group类实例化组对象。整个场景中，scene负责场景的根节点。然后是Group组织旗下的叶子网格模型等。最后再是与网格模型的同级节点的光源，材质等对象的组织。一个模型要想在场景中渲染出来，需要添加到场景中，通过基类Object3D的add方法来添加。</p></blockquote><h4 id="模型对象的删除与添加方法" tabindex="-1"><a class="header-anchor" href="#模型对象的删除与添加方法" aria-hidden="true">#</a> 模型对象的删除与添加方法</h4><ul><li>add</li><li>remove</li></ul><div class="custom-container tip"><p class="custom-container-title">提示</p><p>移除添加子对象的本质就是操作子对象的相对父对象的children数列。</p></div><h3 id="层级模型节点的遍历-查找-命名" tabindex="-1"><a class="header-anchor" href="#层级模型节点的遍历-查找-命名" aria-hidden="true">#</a> 层级模型节点的遍历，查找，命名</h3><h4 id="通过name属性为模型对象添加标记-用来表示子模型对象在整体模型中-所占据的位置。" tabindex="-1"><a class="header-anchor" href="#通过name属性为模型对象添加标记-用来表示子模型对象在整体模型中-所占据的位置。" aria-hidden="true">#</a> 通过name属性为模型对象添加标记，用来表示子模型对象在整体模型中，所占据的位置。</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 伪代码</span>
group<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;头&#39;</span>

<span class="token comment">// 网格模型</span>
mesh<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;眼睛&#39;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="树结构层级模型" tabindex="-1"><a class="header-anchor" href="#树结构层级模型" aria-hidden="true">#</a> 树结构层级模型</h4><blockquote><p>实际开发中，会加载外部模型，然后通过树结构中的节点的name属性去获取子模型对象.</p></blockquote><p><strong>加载机器人模型</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>
<span class="token comment">// 球体网格模型函数</span>
      <span class="token keyword">function</span> <span class="token function">sphereMesh</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">R</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span><span class="token constant">R</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> metarial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x0000ff</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> metarial<span class="token punctuation">)</span><span class="token punctuation">;</span>

        mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> mesh<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 圆柱体网格模型构建函数</span>
      <span class="token keyword">function</span> <span class="token function">cylinderMesh</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">R</span><span class="token punctuation">,</span> h<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CylinderGeometry</span><span class="token punctuation">(</span><span class="token constant">R</span><span class="token punctuation">,</span> <span class="token constant">R</span><span class="token punctuation">,</span> h<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//球体几何体</span>
        <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x0000ff</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//材质对象Material</span>

        <span class="token keyword">let</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建网格模型对象</span>

        mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> mesh<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">let</span> panel <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;panel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">canvas</span><span class="token operator">:</span> panel<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      renderer<span class="token punctuation">.</span><span class="token function">setClearColor</span><span class="token punctuation">(</span><span class="token number">0x888888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span>
        <span class="token number">100</span><span class="token punctuation">,</span>
        window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span>
        <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token number">1000</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置相机所在位置</span>
      camera<span class="token punctuation">.</span><span class="token function">lookAt</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置相机观察方向</span>

      scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//  创建模型</span>
      <span class="token comment">// 头部子模型</span>
      <span class="token keyword">let</span> headMesh <span class="token operator">=</span> <span class="token function">sphereMesh</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      headMesh<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;脑壳&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> leftEyeMesh <span class="token operator">=</span> <span class="token function">sphereMesh</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      leftEyeMesh<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;左眼&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> rightEyeMesh <span class="token operator">=</span> <span class="token function">sphereMesh</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      rightEyeMesh<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;右眼&quot;</span><span class="token punctuation">;</span>
      <span class="token comment">// 头部组</span>
      <span class="token keyword">let</span> headGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      headGroup<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;头部&quot;</span><span class="token punctuation">;</span>
      headGroup<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>headMesh<span class="token punctuation">,</span> leftEyeMesh<span class="token punctuation">,</span> rightEyeMesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 身体网格模型和组</span>
      <span class="token keyword">let</span> neckMesh <span class="token operator">=</span> <span class="token function">cylinderMesh</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      neckMesh<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;脖子&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> bodyMesh <span class="token operator">=</span> <span class="token function">cylinderMesh</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bodyMesh<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;腹部&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> leftLegMesh <span class="token operator">=</span> <span class="token function">cylinderMesh</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      leftLegMesh<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;左腿&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> rightLegMesh <span class="token operator">=</span> <span class="token function">cylinderMesh</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      rightLegMesh<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;右腿&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> legGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      legGroup<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;腿&quot;</span><span class="token punctuation">;</span>
      legGroup<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>leftLegMesh<span class="token punctuation">,</span> rightLegMesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> bodyGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bodyGroup<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;身体&quot;</span><span class="token punctuation">;</span>
      bodyGroup<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>neckMesh<span class="token punctuation">,</span> bodyMesh<span class="token punctuation">,</span> legGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 人Group</span>
      <span class="token keyword">let</span> personGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      personGroup<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;人&quot;</span><span class="token punctuation">;</span>
      personGroup<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>headGroup<span class="token punctuation">,</span> bodyGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
      personGroup<span class="token punctuation">.</span><span class="token function">translateY</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>personGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> ambientLight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AmbientLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ambientLight<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> axesHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AxesHelper</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>axesHelper<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> controls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>OrbitControls</span><span class="token punctuation">(</span>camera<span class="token punctuation">,</span> renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
      controls<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span> render<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>通过组对象，组织模型对象自己就可以构建上面的机器人模型</p></div><h4 id="递归遍历算法traverse" tabindex="-1"><a class="header-anchor" href="#递归遍历算法traverse" aria-hidden="true">#</a> 递归遍历算法traverse</h4><blockquote><p>通过此方法，可以编译创建的模型对象</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 上面的机器人模型</span>
scene<span class="token punctuation">.</span><span class="token function">traverse</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&#39;Group&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&#39;Mesh&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39; &#39;</span> <span class="token operator">+</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        obj<span class="token punctuation">.</span>material<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0xffff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&#39;左眼&#39;</span> <span class="token operator">||</span> obj<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&#39;右眼&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">.</span>material<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0x000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>id<span class="token punctuation">)</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="模型树节点查找" tabindex="-1"><a class="header-anchor" href="#模型树节点查找" aria-hidden="true">#</a> 模型树节点查找</h4><blockquote><p>通过Object3D基类上的查询方法，用来查找特定的节点. 比如， getObjectById, getObjectByName</p></blockquote><h3 id="世界矩阵" tabindex="-1"><a class="header-anchor" href="#世界矩阵" aria-hidden="true">#</a> 世界矩阵</h3><blockquote><p>本节介绍本地坐标和世界坐标</p></blockquote><h4 id="建立世界坐标系概念" tabindex="-1"><a class="header-anchor" href="#建立世界坐标系概念" aria-hidden="true">#</a> 建立世界坐标系概念</h4><blockquote><p>所谓本地坐标系或者说模型坐标系，就是模型对象相对模型的父对象而言，模型位置属性.position表示的坐标值就是以本地坐标系为参考，表示子对象相对本地坐标系原点(0,0,0)的偏移量。 前面两节课说过Threejs场景Scene是一个树结构，一个模型对象可能有多个父对象节点。世界坐标系默认就是对Threejs整个场景Scene建立一个坐标系，一个模型相对世界坐标系的坐标值就是该模型对象所有父对象以及模型本身位置属性.position的叠加。</p></blockquote><h4 id="本地缩放系数" tabindex="-1"><a class="header-anchor" href="#本地缩放系数" aria-hidden="true">#</a> 本地缩放系数</h4><blockquote><p>通过前面的论述，模型的位置属性.position可以称为本地坐标或者说局部坐标，对于属性.scale一样，可以称为模型的本地缩放系数或者局部的缩放系数，通过.getWorldScale()方法可以获得一个模型的世界缩放系数，就像执行.getWorldPosition()方法一样获得世界坐标，关于.getWorldScale()方法可以查看基类Object3D。</p></blockquote><h4 id="本地矩阵和世界矩阵" tabindex="-1"><a class="header-anchor" href="#本地矩阵和世界矩阵" aria-hidden="true">#</a> 本地矩阵和世界矩阵</h4><blockquote><p>本地矩阵.materix是以本地坐标系为参考的模型矩阵，世界矩阵.matrixWorld自然就是以是世界坐标系为参照的模型矩阵。Three.js本地矩阵是 Three.js模型的位置属性.position、缩放系数属性.scale和角度属性.rotation记录了模型的所有平移、缩放和旋转变换，本地矩阵.materix是以线性代数矩阵的形式表示.position、.scale和.rotation。世界矩阵.matrixWorld自然是用矩阵的形式表示模型以及模型父对象的所有旋转缩放平移变换。更多内容可以参考文章《本地矩阵和世界矩阵》</p></blockquote><h2 id="几何体顶点纹理坐标数据-续" tabindex="-1"><a class="header-anchor" href="#几何体顶点纹理坐标数据-续" aria-hidden="true">#</a> 几何体顶点纹理坐标数据(续)</h2><blockquote><p>几何体顶点纹理坐标数据和纹理贴图关系。顶点纹理坐标由几何体产生，纹理贴图使用uv坐标建立对应关系. 纹理图像就是加载纹理时，所使用的图片资源，还可以是其他文件类型，比如视频。纹理坐标，就是纹理图像上的单位像素点。</p></blockquote><p><strong>脑图:</strong></p><img src="/algorithm/assets/uvp.e7ae5d28.jpg"><p>任务点：BufferGemotry获取面的uv映射与更新</p><h2 id="数组材质和材质索引" tabindex="-1"><a class="header-anchor" href="#数组材质和材质索引" aria-hidden="true">#</a> 数组材质和材质索引</h2><blockquote><p>三角面材质和数组材质属性materialIndex</p></blockquote><h4 id="数组材质" tabindex="-1"><a class="header-anchor" href="#数组材质" aria-hidden="true">#</a> 数组材质</h4><blockquote><p>数组材质作为几何体纹理贴图, 所谓数组材质就是多个材质对象构成一个数组作为模型对象的材质。</p></blockquote><div class="custom-container tip"><p class="custom-container-title">提示</p><p>数组材质组合多个材质对象，来实现对模型进行贴图</p></div><h4 id="材质索引" tabindex="-1"><a class="header-anchor" href="#材质索引" aria-hidden="true">#</a> 材质索引</h4><blockquote><p>材质对象数组有专门的索引<code>materialIndex</code>，可以通过设置此值来改变每一个面的材质对象.</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 新版本threejs，可以再groups中访问数组材质对象</span>
 boxgeometry<span class="token punctuation">.</span>groups<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>materialIndex <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>脑图:</strong><img src="/algorithm/assets/metarialIndex.cb993de6.png"></p><h2 id="材质对象texture-的阵列-偏移-选装" tabindex="-1"><a class="header-anchor" href="#材质对象texture-的阵列-偏移-选装" aria-hidden="true">#</a> 材质对象Texture 的阵列，偏移，选装</h2><blockquote><p>纹理对象本质就是一个包含图片的对象，纹理对象所包含的图片就是image属性.</p></blockquote><h3 id="阵列" tabindex="-1"><a class="header-anchor" href="#阵列" aria-hidden="true">#</a> 阵列</h3><blockquote><p>纹理贴图阵列映射</p></blockquote><h4 id="设置纹理的包裹模式" tabindex="-1"><a class="header-anchor" href="#设置纹理的包裹模式" aria-hidden="true">#</a> 设置纹理的包裹模式</h4><blockquote><p>如下常量用于设置纹理贴图的wrapS和wrapT属性，用来控制纹理贴图在水平和垂直方向的排列方式. 常用常量:</p></blockquote><ul><li>THREE.RepeatWrapping</li><li>THREE.ClampToEdgeWrapping</li><li>THREE.MirroredRepeatWrapping</li></ul><p>使用:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>texture<span class="token punctuation">.</span>wrapS <span class="token operator">=</span> <span class="token operator">...</span>
texture<span class="token punctuation">.</span>wrapT <span class="token operator">=</span> <span class="token operator">...</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>实践:</p><blockquote><p>设置纹理的水平垂直队列的无线延伸，THREE.RepeatWrapping. 需要搭配(texture.repeat.set(x, y)).来设置纹理水平和垂直的重复纹理数量</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  texture<span class="token punctuation">.</span>wrapS <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping<span class="token punctuation">;</span>
  texture<span class="token punctuation">.</span>wrapT <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping<span class="token punctuation">;</span>
  <span class="token comment">// uv两个方向纹理重复数量</span>
  texture<span class="token punctuation">.</span>repeat<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>默认几何体是取THREE.clampToEdgeWrapping， 即纹理将延伸到网格边缘. MirroredRepeatWrapping 纹理将重复到无穷大，并且每次重复时将进行镜像.</p></div><h3 id="偏移" tabindex="-1"><a class="header-anchor" href="#偏移" aria-hidden="true">#</a> 偏移</h3><blockquote><p>不设置阵列纹理贴图，设置偏移量</p></blockquote><p>代码:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>texture<span class="token punctuation">.</span>offset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><blockquote><p>通过设置纹理对象的offset属性，来控制纹理图像在网格上的渲染位置，体现就是贴图面积.</p></blockquote><p>demo:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// texture.offset = new THREE.Vector2(x, y)</span>
texture<span class="token punctuation">.</span>offset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token comment">// 纹理贴图面积占网格面一半</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>设置阵列，同时设置偏移</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 设置纹理阵列, 同时设置偏移</span>
texture<span class="token punctuation">.</span>wrapS <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping<span class="token punctuation">;</span>
texture<span class="token punctuation">.</span>wrapT <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping<span class="token punctuation">;</span>
texture<span class="token punctuation">.</span>repeat<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 纹理图像将按照单位纹理坐标(1, 1)进行偏移</span>
texture<span class="token punctuation">.</span>offset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 此时图像将在网格上贴图一半, 在网格面边界处的贴图将偏移到整个纹理贴图的一半</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="纹理旋转" tabindex="-1"><a class="header-anchor" href="#纹理旋转" aria-hidden="true">#</a> 纹理旋转</h3><blockquote><p>设置纹理贴图的旋转角度，和旋转中心</p></blockquote><p>控制属性:</p><ol><li>rotation</li><li>center</li></ol><p>代码:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 设置旋转角度</span>
texture<span class="token punctuation">.</span>rotation <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">// 设置旋转中心, 默认(0, 0)</span>
texture<span class="token punctuation">.</span>center<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>matrix: 物体局部矩阵变换 matrixAutoUpdate: 当这个属性设置了之后，它将计算每一帧的位移、旋转（四元变换）和缩放矩阵，并重新计算matrixWorld属性。默认值是Object3D.DefaultMatrixAutoUpdate (true)。</p></div><p>实践: 创建一个草坪</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * 创建一个地面
 */</span>
<span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PlaneGeometry</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//矩形平面</span>
<span class="token comment">// 加载树纹理贴图</span>
<span class="token keyword">var</span> texture <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;grass.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置阵列</span>
texture<span class="token punctuation">.</span>wrapS <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping<span class="token punctuation">;</span>
texture<span class="token punctuation">.</span>wrapT <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping<span class="token punctuation">;</span>
<span class="token comment">// uv两个方向纹理重复数量</span>
texture<span class="token punctuation">.</span>repeat<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//网格模型对象Mesh</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//网格模型添加到场景中</span>
mesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="纹理动画" tabindex="-1"><a class="header-anchor" href="#纹理动画" aria-hidden="true">#</a> 纹理动画</h3><blockquote><p>纹理动画比较简单，必须要在渲染函数中render()一直执行texture.offset.x -= 0.06动态改变纹理对象Texture的偏移属性.offset就可以。控制纹理偏移</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 渲染函数</span>
<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//执行渲染操作</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 使用加减法可以设置不同的运动方向</span>
  <span class="token comment">// 设置纹理偏移</span>
  texture<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>x <span class="token operator">-=</span> <span class="token number">0.06</span>
<span class="token punctuation">}</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="创建设置重复纹理的管道" tabindex="-1"><a class="header-anchor" href="#创建设置重复纹理的管道" aria-hidden="true">#</a> 创建设置重复纹理的管道</h3><blockquote><p>主要使用 CatmullRomCurve3构造从一系列点创建一条平滑的三维样条曲线</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> curve <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CatmullRomCurve3</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> tubeGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TubeGeometry</span><span class="token punctuation">(</span>curve<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> textureLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> texture <span class="token operator">=</span> textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&#39;run.jpg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置阵列模式为 RepeatWrapping</span>
texture<span class="token punctuation">.</span>wrapS <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping
texture<span class="token punctuation">.</span>wrapT<span class="token operator">=</span><span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping
<span class="token comment">// 设置x方向的偏移(沿着管道路径方向)，y方向默认1</span>
<span class="token comment">//等价texture.repeat= new THREE.Vector2(20,1)</span>
texture<span class="token punctuation">.</span>repeat<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> tubeMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span>
  <span class="token literal-property property">transparent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="画布视频作为纹理贴图" tabindex="-1"><a class="header-anchor" href="#画布视频作为纹理贴图" aria-hidden="true">#</a> 画布视频作为纹理贴图</h2><blockquote><p>CanvasTexture和VideoTexture可以分别实现把Canvas画布、视频作为纹理贴图使用。</p></blockquote><h3 id="canvas画布作为纹理贴图-实质是利用2d-api绘制各种形状然后应用到3d网格模型。" tabindex="-1"><a class="header-anchor" href="#canvas画布作为纹理贴图-实质是利用2d-api绘制各种形状然后应用到3d网格模型。" aria-hidden="true">#</a> canvas画布作为纹理贴图, 实质是利用2D api绘制各种形状然后应用到3D网格模型。</h3><ul><li>使用canvas api绘制2d图形，作为构建纹理对象</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 创建平面，加入canvas对象，使用CanvasTexture作为创建纹理对象的构造</span>
      <span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PlaneGeometry</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> texture <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CanvasTexture</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>house<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> metarial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span>
        <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> metarial<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>canvas加载图形作为纹理对象</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// imgPatter 事先加载了图片</span>
<span class="token function">imgPatter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">canvas</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> texture <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CanvasTexture</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 默认开启needsUpdate</span>
        <span class="token comment">// texture.needsUpdate = true;</span>
        <span class="token keyword">let</span> metarial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span>
          <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> metarial<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mesh<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        editor<span class="token punctuation">.</span>globals<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>
        editor<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>加载视频作为纹理贴图</li></ul><blockquote><p>视频本质上就是一帧帧图片流构成，把视频作为Threejs模型的纹理贴图使用，就是从视频中提取一帧一帧的图片作为模型的纹理贴图，然后不停的更新的纹理贴图就可以产生视频播放的效果。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> vtexture <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>VideoTexture</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>video<span class="token punctuation">)</span><span class="token punctuation">;</span>
      vtexture<span class="token punctuation">.</span>needsUpdate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">map</span><span class="token operator">:</span> vtexture<span class="token punctuation">,</span>
        <span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
      mesh<span class="token punctuation">.</span><span class="token function">translateY</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      editor<span class="token punctuation">.</span>globals<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>官方的内置构造 VideoTexture用来加载视频创建纹理.VideoTexture.js封装了一个update函数，Threejs每次执行渲染方法进行渲染场景中的时候，都会执行VideoTexture封装的update函数，执行update函数中代码this.needsUpdate = true;读取视频流最新一帧图片来更新Threejs模型纹理贴图。</p></div><h3 id="凹凸-法线贴图" tabindex="-1"><a class="header-anchor" href="#凹凸-法线贴图" aria-hidden="true">#</a> 凹凸，法线贴图</h3><blockquote><p>凹凸贴图（bumpMap）和法线贴图(normalMap). 对于复杂的曲面模型，模型包含的顶点数据比较多。模型文件体积也比较大。这种场景下使用normalMap贴图算法，就能够有效压缩模型大小。三维模型的3d美术设计，可以通过减面操作将精模简化为简模，开发就可以将美术导出的复杂集合信息纹理映射到normalMap上。</p></blockquote><p>脑图：</p><img src="/algorithm/assets/textureNormal.341acb78.png"><h4 id="法线贴图" tabindex="-1"><a class="header-anchor" href="#法线贴图" aria-hidden="true">#</a> 法线贴图</h4><blockquote><p>法线贴图就是将精模的复杂几何信息单独作为图片导出，然后将此贴图用于低模的贴图，达到高模的逼真效果。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code> <span class="token comment">//   let geometry = new THREE.BoxGeometry(400, 400, 400);</span>

      <span class="token comment">// 创建法线贴图</span>
      <span class="token comment">//   let loader = new THREE.TextureLoader().load(</span>
      <span class="token comment">//     &quot;./static/normal2.jpeg&quot;,</span>
      <span class="token comment">//     (texture) =&gt; {</span>
      <span class="token comment">//       console.log(texture);</span>
      <span class="token comment">//       let material = new THREE.MeshPhongMaterial({</span>
      <span class="token comment">//         // map: texture,</span>
      <span class="token comment">//         color: 0xff0000,</span>
      <span class="token comment">//         normalMap: texture, // 使用法线贴图</span>
      <span class="token comment">//         normalScale: new THREE.Vector2(10, 10),</span>
      <span class="token comment">//       });</span>
      <span class="token comment">//       let mesh = new THREE.Mesh(geometry, material);</span>
      <span class="token comment">//       mesh.translateY(300);</span>
      <span class="token comment">//       editor.globals.scene.add(mesh);</span>
      <span class="token comment">//       editor.render();</span>
      <span class="token comment">//     },</span>
      <span class="token comment">//     undefined,</span>
      <span class="token comment">//     (e) =&gt; {}</span>
      <span class="token comment">//   );</span>
      <span class="token comment">//   var textureLoader = new THREE.TextureLoader();</span>
      <span class="token comment">//   // 加载法线贴图</span>
      <span class="token comment">//   var textureNormal = textureLoader.load(&quot;./static/normal2.jpeg&quot;);</span>
      <span class="token comment">//   var material = new THREE.MeshPhongMaterial({</span>
      <span class="token comment">//     color: 0xff0000,</span>
      <span class="token comment">//     // map: textureNormal,</span>
      <span class="token comment">//     normalMap: textureNormal, //法线贴图</span>
      <span class="token comment">//     //设置深浅程度，默认值(1,1)。</span>
      <span class="token comment">//     normalScale: new THREE.Vector2(10, 10),</span>
      <span class="token comment">//   }); //材质对象Material</span>
      <span class="token comment">//   var mesh = new THREE.Mesh(geometry, material); //网格模型对象Mesh</span>
      <span class="token comment">//   editor.globals.scene.add(mesh);</span>

      <span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//球体</span>
      <span class="token comment">// TextureLoader创建一个纹理加载器对象，可以加载图片作为几何体纹理</span>
      <span class="token keyword">var</span> textureLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//   // 加载纹理贴图</span>
      <span class="token comment">//   var texture = textureLoader.load(&quot;./static/earthnormal.png&quot;);</span>
      <span class="token comment">// 加载法线贴图</span>
      <span class="token keyword">var</span> textureNormal <span class="token operator">=</span> textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;./static/earthnormal.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x0000ff</span><span class="token punctuation">,</span>
        <span class="token literal-property property">map</span><span class="token operator">:</span> textureNormal<span class="token punctuation">,</span> <span class="token comment">// 普通颜色纹理贴图</span>
        <span class="token literal-property property">normalMap</span><span class="token operator">:</span> textureNormal<span class="token punctuation">,</span> <span class="token comment">//法线贴图</span>
        <span class="token comment">//设置深浅程度，默认值(1,1)。</span>
        <span class="token literal-property property">normalScale</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//材质对象Material</span>
      <span class="token keyword">var</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//网格模型对象Mesh</span>
      editor<span class="token punctuation">.</span>globals<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><h4 id="凹凸贴图" tabindex="-1"><a class="header-anchor" href="#凹凸贴图" aria-hidden="true">#</a> 凹凸贴图</h4><blockquote><p>凹凸贴图和法线贴图功能相似，只是没有法线贴图表达的几何体表面信息更丰富。凹凸贴图是用图片像素的灰度值表示几何表面的高低深度，如果模型定义了法线贴图，就没有必要在使用凹凸贴图。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code> <span class="token function">injectText</span><span class="token punctuation">(</span><span class="token string">&quot;红色代表 X 轴. 绿色代表 Y 轴. 蓝色代表 Z 轴.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> editor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Editor</span><span class="token punctuation">(</span><span class="token constant">THREE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> controls <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">bumpScale</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> gui <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dat<span class="token punctuation">.</span>GUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      gui<span class="token punctuation">.</span><span class="token function">addFolder</span><span class="token punctuation">(</span><span class="token string">&quot;添加凹凸控制器&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//球体</span>
      <span class="token keyword">var</span> geometry2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//球体</span>
      <span class="token keyword">var</span> textureLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 加载颜色纹理贴图</span>
      <span class="token keyword">var</span> texture <span class="token operator">=</span> textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;./static/diffuse.jpeg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 加载凹凸贴图</span>
      <span class="token keyword">var</span> textureBump <span class="token operator">=</span> textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;./static/bumpMap.jpeg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span> <span class="token comment">// 普通纹理贴图</span>
        <span class="token literal-property property">bumpMap</span><span class="token operator">:</span> textureBump<span class="token punctuation">,</span> <span class="token comment">//凹凸贴图</span>
        <span class="token literal-property property">bumpScale</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">//设置凹凸高度，默认值1。</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//材质对象Material</span>
      <span class="token keyword">var</span> material2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span> <span class="token comment">// 普通纹理贴图</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//材质对象Material</span>
      <span class="token keyword">var</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//网格模型对象Mesh</span>
      <span class="token keyword">var</span> mesh2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry2<span class="token punctuation">,</span> material2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//网格模型对象Mesh</span>
      mesh<span class="token punctuation">.</span>material<span class="token punctuation">.</span>needsUpdate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      mesh<span class="token punctuation">.</span><span class="token function">translateX</span><span class="token punctuation">(</span><span class="token number">450</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      gui<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>controls<span class="token punctuation">,</span> <span class="token string">&quot;bumpScale&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        mesh<span class="token punctuation">.</span>material<span class="token punctuation">.</span>bumpScale <span class="token operator">=</span> e<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      gui<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      editor<span class="token punctuation">.</span>globals<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>
      editor<span class="token punctuation">.</span>globals<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh2<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 添加光源</span>
      <span class="token keyword">const</span> light <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AmbientLight</span><span class="token punctuation">(</span><span class="token number">0xcccccc</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// soft white light</span>
      editor<span class="token punctuation">.</span>globals<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>light<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 添加辅助对象</span>
      <span class="token keyword">const</span> length <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> arrowHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      arrowHelper<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;arrowHelper&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> origin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> dirX <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> dirY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> dirZ <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      arrowHelper<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>ArrowHelper</span><span class="token punctuation">(</span>dirX<span class="token punctuation">,</span> origin<span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token number">0xff0000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      arrowHelper<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>ArrowHelper</span><span class="token punctuation">(</span>dirY<span class="token punctuation">,</span> origin<span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token number">0x00ff00</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      arrowHelper<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>ArrowHelper</span><span class="token punctuation">(</span>dirZ<span class="token punctuation">,</span> origin<span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token number">0x0000ff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      editor<span class="token punctuation">.</span><span class="token function">injectHelper</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">girdhelper</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>GridHelper</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// axeshlper: new THREE.AxesHelper(1000),</span>
        arrowHelper<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>geometry<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>

        editor<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><h3 id="光照贴图添加阴影" tabindex="-1"><a class="header-anchor" href="#光照贴图添加阴影" aria-hidden="true">#</a> 光照贴图添加阴影</h3><blockquote><p>三维场景中，有时需要设置模型的阴影。有两种方式实现，其一就是通过计算光线和物体之间的光线投射，来形成阴影。不过这种是通过计算得到，比较消耗资源；其二就是由3d美术设计的阴影贴图。直接就可以作为物体阴影，不需要额外计算。</p></blockquote><p><strong>废弃属性:</strong></p><blockquote><p>Geometry属性.faceVertexUvs 一般几何体有两套UV坐标，对于Geometry类型几何体而言</p></blockquote><p>Geometry.faceVertexUvs[0]包含的纹理坐标用于颜色贴图map、法线贴图normalMap等,Geometry.faceVertexUvs[1]包含的第二套纹理贴图用于光照阴影贴图</p><p>一般通过Threejs几何体API创建的几何体默认只有一组纹理坐标Geometry.faceVertexUvs[0]，所以为了设置光照阴影贴图，需要给另一组纹理坐标赋值Geometry.faceVertexUvs[1] = Geometry.faceVertexUvs[0];</p><p><strong>新版本threejs</strong></p><blockquote><p>一般通过Threejs加载外部模型，解析三维模型数据得到的几何体类型是缓冲类型几何体BufferGeometry，对于BufferGeometry而言两套纹理坐标分别通过.uv和.uv2属性表示。</p></blockquote><p>示列demo:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PlaneGeometry</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      geometry<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;uv2&quot;</span><span class="token punctuation">,</span> geometry<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;uv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置用于光照阴影贴图用的uv坐标</span>

      <span class="token comment">// 创建阴影贴图</span>
      <span class="token keyword">var</span> textureLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 加载光照贴图</span>
      <span class="token keyword">var</span> textureLight <span class="token operator">=</span> textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;./static/shadow3.jpeg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x999999</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lightMap</span><span class="token operator">:</span> textureLight<span class="token punctuation">,</span> <span class="token comment">// 设置光照贴图</span>
        <span class="token literal-property property">lightMapIntensity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//烘培光照的强度. 默认 1.</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> plane <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
      plane<span class="token punctuation">.</span><span class="token function">rotateX</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      editor<span class="token punctuation">.</span>globals<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>plane<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>贴图使用的纹理坐标由两种，一种是几何体面用的uv坐标；另一种是阴影贴图用的uv坐标。默认创建的几何体只有第一个uv坐标，光照uv坐标需要额外设置。<code>gemotry.setAttribute(&#39;uv2&#39;, gemotry.getAttribute(&#39;uv&#39;))</code></p></div><blockquote><p>两组纹理坐标通常表示为<code>uv</code>,<code>uv2</code></p></blockquote><h3 id="高光贴图" tabindex="-1"><a class="header-anchor" href="#高光贴图" aria-hidden="true">#</a> 高光贴图</h3><blockquote><p>高光网格材质MeshPhongMaterial具有高光属性.specular,如果一个网格模型Mesh都是相同的材质并且表面粗糙度相同,或者说网格模型外表面所有不同区域的镜面反射能力相同，可以直接设置材质的高光属性.specular。如果一个网格模型表示一个人，那么人的不同部位高光程度是不同的，不可能直接通过.specular属性来描述，在这种情况通过高光贴图.specularMap的RGB值来描述不同区域镜面反射的能力，.specularMap和颜色贴图.Map一样和通过UV坐标映射到模型表面。高光贴图.specularMap不同区域像素值不同，表示网格模型不同区域的高光值不同。 高光贴图属性.specularMap和高光属性.specular是对应的，也就是说只有高光网格材质对象MeshPhongMaterial才具备高光贴图属性.specularMap。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 加载纹理贴图</span>
<span class="token keyword">var</span> texture <span class="token operator">=</span> textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&#39;earth_diffuse.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 加载高光贴图</span>
<span class="token keyword">var</span> textureSpecular <span class="token operator">=</span> textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&#39;earth_specular.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// specular: 0xff0000,//高光部分的颜色</span>
  <span class="token literal-property property">shininess</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span><span class="token comment">//高光部分的亮度，默认30</span>
  <span class="token literal-property property">map</span><span class="token operator">:</span> texture<span class="token punctuation">,</span><span class="token comment">// 普通纹理贴图</span>
  <span class="token literal-property property">specularMap</span><span class="token operator">:</span> textureSpecular<span class="token punctuation">,</span> <span class="token comment">//高光贴图</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//材质对象Material</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="环境贴图" tabindex="-1"><a class="header-anchor" href="#环境贴图" aria-hidden="true">#</a> 环境贴图</h3><blockquote><p>Three.js环境贴图.envMap字面意思就是三维模型周边环境，比如你渲染一个立方体，立方体放在一个屋子里面，屋子里面的周边环境肯定影响立方体的渲染效果，目的是为了渲染该立方体而不是立方体周围环境，为了更方便所以没必要创建立方体周边环境所有物体的网格模型，可以通过图片来表达立方体周边的环境。 高光网格材质MeshPhongMaterial和物理PBR材质MeshStandardMaterial通常会使用环境贴图.envMap来实现更好的渲染效果。一个材质对应的是普通次时代模型，一个材质对应的是PBR模型。</p></blockquote><ul><li>envMap</li><li>CubeTextureLoader</li><li></li></ul><h3 id="数据纹理贴图" tabindex="-1"><a class="header-anchor" href="#数据纹理贴图" aria-hidden="true">#</a> 数据纹理贴图</h3><blockquote><p>Three.js数据纹理对象DataTexture简单地说就是通过程序创建纹理贴图的每一个像素值。</p></blockquote><ul><li>DataTexture</li></ul><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">最近更新于: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 22212@qq.com">wangshan</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/algorithm/assets/app.3aa91c68.js" defer></script>
  </body>
</html>
